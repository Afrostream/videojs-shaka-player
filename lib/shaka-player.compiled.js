(function(){var g={};
(function(window){var k,aa=this;function n(a,b){var c=a.split("."),d=aa;c[0]in d||!d.execScript||d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)c.length||void 0===b?d[e]?d=d[e]:d=d[e]={}:d[e]=b}function p(a,b){function c(){}c.prototype=b.prototype;a.Ib=b.prototype;a.prototype=new c;a.prototype.constructor=a;a.Gb=function(a,c,f){return b.prototype[c].apply(a,Array.prototype.slice.call(arguments,2))}};function ba(){};function ca(a){var b=console[a];b?b.bind||(console[a]=function(){b.apply(console,arguments)}):console[a]=function(){}}ca("error");ca("warn");ca("info");ca("log");ca("debug");function da(a){ea[a]={ha:fa(),end:NaN}}function ga(a){if(a=ea[a])a.end=fa()}function ha(a){return(a=ea[a])&&a.end?a.end-a.ha:NaN}var fa=window.performance&&window.performance.now?window.performance.now.bind(window.performance):Date.now,ea={};function ia(a){this.b=a;this.a=new ja(a);ka||(ka=[new Uint8Array([255]),new Uint8Array([127,255]),new Uint8Array([63,255,255]),new Uint8Array([31,255,255,255]),new Uint8Array([15,255,255,255,255]),new Uint8Array([7,255,255,255,255,255]),new Uint8Array([3,255,255,255,255,255,255]),new Uint8Array([1,255,255,255,255,255,255,255])])}var ka;
function la(a){var b;b=ma(a);if(7<b.length)throw new RangeError("EbmlParser: EBML ID must be at most 7 bytes.");for(var c=0,d=0;d<b.length;d++)c=256*c+b[d];b=c;c=ma(a);a:{for(d=0;d<ka.length;d++)if(na(c,ka[d])){d=!0;break a}d=!1}if(d)throw new RangeError("EbmlParser: Element cannot contain dynamically sized data.");if(8==c.length&&c[1]&224)throw new RangeError("EbmlParser: Variable sized integer value must be at most 53 bits.");for(var d=c[0]&(1<<8-c.length)-1,e=1;e<c.length;e++)d=256*d+c[e];c=d;
c=a.a.a+c<=a.b.byteLength?c:a.b.byteLength-a.a.a;d=new DataView(a.b.buffer,a.b.byteOffset+a.a.a,c);oa(a.a,c);return new pa(b,d)}function ma(a){var b=qa(a.a),c;for(c=1;8>=c&&!(b&1<<8-c);c++);if(8<c)throw new RangeError("EbmlParser: Variable sized integer must fit within 8 bytes.");var d=new Uint8Array(c);d[0]=b;for(b=1;b<c;b++)d[b]=qa(a.a);return d}function pa(a,b){this.id=a;this.a=b}
function ra(a){if(8<a.a.byteLength)throw new RangeError("EbmlElement: Unsigned integer has too many bytes.");if(8==a.a.byteLength&&a.a.getUint8(0)&224)throw new RangeError("EbmlParser: Unsigned integer must be at most 53 bits.");for(var b=0,c=0;c<a.a.byteLength;c++)var d=a.a.getUint8(c),b=256*b+d;return b};function v(){this.a={}}v.prototype.push=function(a,b){this.a.hasOwnProperty(a)?this.a[a].push(b):this.a[a]=[b]};v.prototype.get=function(a){return(a=this.a[a])?a.slice():null};function sa(a){var b=[],c;for(c in a.a)b.push.apply(b,a.a[c]);return b}function ta(a,b,c){if(a=a.a[b])for(b=0;b<a.length;++b)a[b]==c&&(a.splice(b,1),--b)}function ua(a){var b=[],c;for(c in a.a)b.push(c);return b};function y(a){this.ta=new v;this.j=a}n("shaka.util.FakeEventTarget",y);y.prototype.addEventListener=function(a,b,c){c||this.ta.push(a,b)};y.prototype.removeEventListener=function(a,b,c){c||ta(this.ta,a,b)};y.prototype.dispatchEvent=function(a){delete a.srcElement;delete a.target;delete a.currentTarget;Object.defineProperties(a,{srcElement:{value:null,writable:!0},target:{value:this,writable:!0},currentTarget:{value:null,writable:!0}});return va(this,a)};
function va(a,b){b.currentTarget=a;for(var c=a.ta.get(b.type)||[],d=0;d<c.length;++d){var e=c[d];try{e.handleEvent?e.handleEvent(b):e.call(a,b)}catch(f){}}a.j&&b.bubbles&&va(a.j,b);return b.defaultPrevented};function ja(a){var b=xa;this.b=a;this.c=b==ya;this.a=0}var xa=0,ya=1;function za(a){return a.a<a.b.byteLength}function qa(a){var b=a.b.getUint8(a.a);a.a+=1;return b}function z(a){var b=a.b.getUint32(a.a,a.c);a.a+=4;return b}function Aa(a){var b,c;a.c?(b=a.b.getUint32(a.a,!0),c=a.b.getUint32(a.a+4,!0)):(c=a.b.getUint32(a.a,!1),b=a.b.getUint32(a.a+4,!1));if(2097151<c)throw new RangeError("DataViewReader: Overflow reading 64-bit value.");a.a+=8;return c*Math.pow(2,32)+b}
function Ba(a){if(a.a+16>a.b.byteLength)throw new RangeError("DataViewReader: Read past end of DataView.");var b=new Uint8Array(a.b.buffer,a.a,16);a.a+=16;return b}function oa(a,b){if(a.a+b>a.b.byteLength)throw new RangeError("DataViewReader: Skip past end of DataView.");a.a+=b};function B(){var a,b,c=new Promise(function(c,e){a=c;b=e});c.resolve=a;c.reject=b;return c};function Ca(a){return String.fromCharCode.apply(null,a)}n("shaka.util.Uint8ArrayUtils.toString",Ca);function Da(a){for(var b=new Uint8Array(a.length),c=0;c<a.length;++c)b[c]=a.charCodeAt(c);return b}n("shaka.util.Uint8ArrayUtils.fromString",Da);function Ea(a,b){var c=void 0==b?!0:b,d=window.btoa(Ca(a)).replace(/\+/g,"-").replace(/\//g,"_");return c?d:d.replace(/=*$/,"")}n("shaka.util.Uint8ArrayUtils.toBase64",Ea);function Fa(a){return Da(window.atob(a.replace(/-/g,"+").replace(/_/g,"/")))}
n("shaka.util.Uint8ArrayUtils.fromBase64",Fa);n("shaka.util.Uint8ArrayUtils.fromHex",function(a){for(var b=new Uint8Array(a.length/2),c=0;c<a.length;c+=2)b[c/2]=window.parseInt(a.substr(c,2),16);return b});function Ga(a){for(var b="",c=0;c<a.length;++c){var d=a[c].toString(16);1==d.length&&(d="0"+d);b+=d}return b}n("shaka.util.Uint8ArrayUtils.toHex",Ga);function na(a,b){if(!a&&!b)return!0;if(!a||!b||a.length!=b.length)return!1;for(var c=0;c<a.length;++c)if(a[c]!=b[c])return!1;return!0};function Ha(a){this.systemIds=[];this.cencKeyIds=[];a=new ja(new DataView(a.buffer));try{for(;za(a);){var b=a.a,c=z(a),d=z(a);1==c?c=Aa(a):0==c&&(c=a.b.byteLength-b);if(1886614376!=d)oa(a,c-(a.a-b));else{var e=qa(a);if(1<e)oa(a,c-(a.a-b));else{oa(a,3);var f=Ga(Ba(a)),g=[];if(0<e)for(var h=z(a),l=0;l<h;++l){var m=Ga(Ba(a));g.push(m)}var t=z(a);oa(a,t);this.cencKeyIds.push.apply(this.cencKeyIds,g);this.systemIds.push(f);a.a!=b+c&&oa(a,c-(a.a-b))}}}}catch(q){}};function Ia(a){this.c=Math.exp(Math.log(.5)/a);this.a=this.b=0}Ia.prototype.sample=function(a,b){var c=Math.pow(this.c,a);this.b=b*(1-c)+c*this.b;this.a+=a};function Ja(a){return a.b/(1-Math.pow(a.c,a.a))};function C(a,b){return b.bind(a)};function E(a){var b=new CustomEvent(a.type,{detail:a.detail,bubbles:!!a.bubbles}),c;for(c in a)c in b||(b[c]=a[c]);return b}function G(a){return new CustomEvent("error",{detail:a,bubbles:!0})};function Ka(){this.a=new v}Ka.prototype.destroy=function(){La(this);this.a=null};function H(a,b,c,d){b=new Ma(b,c,d);a.a.push(c,b)}Ka.prototype.ma=function(a,b){for(var c=this.a.get(b)||[],d=0;d<c.length;++d){var e=c[d];e.target==a&&(e.ma(),ta(this.a,b,e))}};function La(a){for(var b=sa(a.a),c=0;c<b.length;++c)b[c].ma();a.a.a={}}function Ma(a,b,c){this.target=a;this.type=b;this.a=c;this.target.addEventListener(b,c,!1)}
Ma.prototype.ma=function(){this.target&&(this.target.removeEventListener(this.type,this.a,!1),this.a=this.target=null)};function Na(a,b){y.call(this,b);this.a=null;this.h=a}p(Na,y);
function Oa(a){if(!window.indexedDB)return a=Error("Persistant storage requires IndexedDB support."),Promise.reject(a);if(a.a)return a=Error("A database connection is already open."),Promise.reject(a);var b=new B,c=window.indexedDB.open("content_database",1);c.onupgradeneeded=C(a,function(a){this.a=a.target.result;Pa(this,"group_store",{keyPath:"group_id"});Pa(this,"stream_index_store",{keyPath:"stream_id"});a=Pa(this,"content_store",{autoIncrement:"true"});a.createIndex("segment",["stream_id","segment_id"],
{unique:!0});a.createIndex("stream","stream_id",{unique:!1})});c.onsuccess=C(a,function(a){this.a=a.target.result;b.resolve()});c.onerror=function(){b.reject(c.error)};return b}function J(a){a.a&&(a.a.close(),a.a=null)}function Pa(a,b,c){a.a.objectStoreNames.contains(b)&&a.a.deleteObjectStore(b);return a.a.createObjectStore(b,c)}function Qa(a){return Ra(a,"content_store")}function Sa(a){return Ra(a,"stream_index_store")}function Ta(a){return Ra(a,"group_store")}
function Ra(a,b){return a.a.transaction([b],a.h).objectStore(b)}function Ua(a,b){var c=new B,d=a.get(b);d.onerror=function(){c.reject(d.error)};d.onsuccess=function(){if(d.result)c.resolve(d.result);else{var a=Error("Item not found.");a.type="storage";c.reject(a)}};return c};function Va(){Na.call(this,"readonly",null)}p(Va,Na);function Wa(a){var b=new B,c=[],d=Ta(a).openCursor();d.onerror=function(){b.reject(d.error)};d.onsuccess=function(a){(a=a.target.result)?(c.push(a.key),a.continue()):b.resolve(c)};return b}
function Xa(a,b){return Ua(Ta(a),b).then(C(a,function(a){return a.hasOwnProperty("duration")||a.hasOwnProperty("key_system")?Promise.resolve(a):Ya(this,a.stream_ids[0]).then(function(b){a.duration=b.duration;a.key_system=b.key_system;return Promise.resolve(a)})}))}function Ya(a,b){return Ua(Sa(a),b)}function Za(a,b,c){return Ua(Qa(a).index("segment"),[b,c]).then(function(a){return Promise.resolve(a.content)})};function $a(){y.call(this,null);this.a=new Ia(3);this.c=new Ia(10);this.b=0}p($a,y);n("shaka.util.EWMABandwidthEstimator",$a);$a.prototype.sample=function(a,b){if(!(65536>b)){a=Math.max(a,50);var c=8E3*b/a,d=a/1E3;this.a.sample(d,c);this.c.sample(d,c);this.dispatchEvent(E({type:"bandwidth"}));this.b=Date.now()}};$a.prototype.getBandwidth=function(){return.5>this.a.a?5E5:Math.min(Ja(this.a),Ja(this.c))};$a.prototype.getDataAge=function(){return(Date.now()-this.b)/1E3};
$a.prototype.supportsCaching=function(){return!1};function ab(a){return Object.keys(a).map(function(b){return a[b]})}function bb(a,b){var c=cb(a,b,"number");if(null==c)return null;if(isNaN(c)||c==Number.NEGATIVE_INFINITY||c==Number.POSITIVE_INFINITY)throw new RangeError("'"+b+"' must be finite.");if(0>c)throw new RangeError("'"+b+"' must be >= 0");return c}function cb(a,b,c){a=a[b];if(null==a)return null;if(typeof a!=c)throw new TypeError("'"+b+"' must be a "+c+".");return a}
function db(a,b,c){a=a[b];if(null==a)return null;if(!(a instanceof c))throw new TypeError("'"+b+"' must be an instance of "+c.name+".");return a};function eb(a,b,c){fb(b);fb(c);return c==b||a>=gb&&c==b.split("-")[0]||a>=hb&&c.split("-")[0]==b.split("-")[0]?!0:!1}var gb=1,hb=2;function fb(a){a=a.toLowerCase().split("-");var b=ib[a[0]];b&&(a[0]=b);return a.join("-")}
var ib={aar:"aa",abk:"ab",afr:"af",aka:"ak",alb:"sq",amh:"am",ara:"ar",arg:"an",arm:"hy",asm:"as",ava:"av",ave:"ae",aym:"ay",aze:"az",bak:"ba",bam:"bm",baq:"eu",bel:"be",ben:"bn",bih:"bh",bis:"bi",bod:"bo",bos:"bs",bre:"br",bul:"bg",bur:"my",cat:"ca",ces:"cs",cha:"ch",che:"ce",chi:"zh",chu:"cu",chv:"cv",cor:"kw",cos:"co",cre:"cr",cym:"cy",cze:"cs",dan:"da",deu:"de",div:"dv",dut:"nl",dzo:"dz",ell:"el",eng:"en",epo:"eo",est:"et",eus:"eu",ewe:"ee",fao:"fo",fas:"fa",fij:"fj",fin:"fi",fra:"fr",fre:"fr",
fry:"fy",ful:"ff",geo:"ka",ger:"de",gla:"gd",gle:"ga",glg:"gl",glv:"gv",gre:"el",grn:"gn",guj:"gu",hat:"ht",hau:"ha",heb:"he",her:"hz",hin:"hi",hmo:"ho",hrv:"hr",hun:"hu",hye:"hy",ibo:"ig",ice:"is",ido:"io",iii:"ii",iku:"iu",ile:"ie",ina:"ia",ind:"id",ipk:"ik",isl:"is",ita:"it",jav:"jv",jpn:"ja",kal:"kl",kan:"kn",kas:"ks",kat:"ka",kau:"kr",kaz:"kk",khm:"km",kik:"ki",kin:"rw",kir:"ky",kom:"kv",kon:"kg",kor:"ko",kua:"kj",kur:"ku",lao:"lo",lat:"la",lav:"lv",lim:"li",lin:"ln",lit:"lt",ltz:"lb",lub:"lu",
lug:"lg",mac:"mk",mah:"mh",mal:"ml",mao:"mi",mar:"mr",may:"ms",mkd:"mk",mlg:"mg",mlt:"mt",mon:"mn",mri:"mi",msa:"ms",mya:"my",nau:"na",nav:"nv",nbl:"nr",nde:"nd",ndo:"ng",nep:"ne",nld:"nl",nno:"nn",nob:"nb",nor:"no",nya:"ny",oci:"oc",oji:"oj",ori:"or",orm:"om",oss:"os",pan:"pa",per:"fa",pli:"pi",pol:"pl",por:"pt",pus:"ps",que:"qu",roh:"rm",ron:"ro",rum:"ro",run:"rn",rus:"ru",sag:"sg",san:"sa",sin:"si",slk:"sk",slo:"sk",slv:"sl",sme:"se",smo:"sm",sna:"sn",snd:"sd",som:"so",sot:"st",spa:"es",sqi:"sq",
srd:"sc",srp:"sr",ssw:"ss",sun:"su",swa:"sw",swe:"sv",tah:"ty",tam:"ta",tat:"tt",tel:"te",tgk:"tg",tgl:"tl",tha:"th",tib:"bo",tir:"ti",ton:"to",tsn:"tn",tso:"ts",tuk:"tk",tur:"tr",twi:"tw",uig:"ug",ukr:"uk",urd:"ur",uzb:"uz",ven:"ve",vie:"vi",vol:"vo",wel:"cy",wln:"wa",wol:"wo",xho:"xh",yid:"yi",yor:"yo",zha:"za",zho:"zh",zul:"zu"};function jb(){return Date.now()+kb}var kb=0;function lb(){this.g=new B;this.f=!1;this.a=null;this.b=[];this.c=null}function mb(a,b){if(a.f)throw Error("Cannot append to a running task!");a.b.push(b)}lb.prototype.start=function(){if(this.f)throw Error("Task already started!");this.f=!0;this.b.unshift(function(){});nb(this,void 0)};lb.prototype.end=function(){this.b.splice(1)};
function nb(a,b){var c=a.b[0](b),d;c?(d=c[0],a.c=c[1]):(d=Promise.resolve(),a.c=null);d.then(C(a,function(a){this.a?(this.b=[],this.c=null,ob(this)):(this.b.shift(),this.b.length?nb(this,a):(this.g.resolve(a),this.c=null))})).catch(C(a,function(a){this.b=[];this.c=null;this.a?ob(this):this.g.reject(a)}))}function ob(a){var b=Error("Task aborted.");b.type="aborted";a.g.reject(b);window.setTimeout(function(){this.a.resolve();this.a=null}.bind(a),5)};function pb(a,b){for(var c={},d=0;d<a.length;++d){var e=b?b(a[d]):a[d].toString();c[e]=a[d]}var d=[],f;for(f in c)d.push(c[f]);return d};function qb(a,b,c,d,e,f,g,h,l,m,t){this.b=a;this.i=b;this.u=c;this.a=[];this.c=e||null;this.f=f||null;this.j=g==rb;this.l=h==sb;this.h=l||"";this.v=m||"";this.g=t||null;d&&this.a.push(d)}n("shaka.player.DrmSchemeInfo",qb);var rb=1;qb.DistinctiveIdentifier={OPTIONAL:0,REQUIRED:rb};var sb=1;qb.PersistentState={OPTIONAL:0,REQUIRED:sb};function tb(){this.minBandwidth=this.maxBandwidth=this.maxWidth=this.maxHeight=null}
tb.prototype.clone=function(){var a=new tb;a.maxHeight=this.maxHeight;a.maxWidth=this.maxWidth;a.maxBandwidth=this.maxBandwidth;a.minBandwidth=this.minBandwidth;return a};function ub(){return new qb("","",!1,null)}qb.createUnencrypted=ub;function vb(a,b){a.a=pb(a.a.concat(b.a),function(a){return Array.prototype.join.apply(a.initData)})}qb.combine=vb;qb.prototype.key=function(){return JSON.stringify(this)};function wb(a,b,c){this.id=a;this.bandwidth=b||0;this.lang=c||"unknown";this.active=!1}n("shaka.player.AudioTrack.compare",function(a,b){return a.lang<b.lang?-1:a.lang>b.lang?1:a.bandwidth<b.bandwidth?-1:a.bandwidth>b.bandwidth?1:0});function xb(){this.fontSize="100%";this.fontColor=yb;this.fontOpacity=zb;this.backgroundColor=Ab;this.backgroundOpacity=zb;this.fontEdge=Bb}n("shaka.player.TextStyle",xb);xb.prototype.a=function(){var a=window.localStorage.getItem("ShakaPlayerTextStyle");if(a){var b;try{b=JSON.parse(a)}catch(c){return}if(b&&"object"==typeof b){var a=b,d;for(d in a)d in this&&(this[d]=a[d])}}};xb.prototype.load=xb.prototype.a;xb.prototype.b=function(){window.localStorage.setItem("ShakaPlayerTextStyle",JSON.stringify(this))};
xb.prototype.store=xb.prototype.b;function Cb(a){var b=[];b.push("font-size: "+a.fontSize);b.push("color: "+Db(a.fontColor,a.fontOpacity));b.push("background-color: "+Db(a.backgroundColor,a.backgroundOpacity));for(var c=[],d=0;d<a.fontEdge.length;++d){var e=a.fontEdge[d].slice(3,6);c.push(Db(a.fontEdge[d].slice(0,3),a.fontOpacity)+" "+e.join("px ")+"px")}b.push("text-shadow: "+c.join(","));return b.join("; ")}function Db(a,b){return"rgba("+a.concat(b).join(",")+")"}var yb=[255,255,255],Ab=[0,0,0];
xb.StandardColors={WHITE:yb,BLACK:Ab,RED:[255,0,0],GREEN:[0,255,0],BLUE:[0,0,255],YELLOW:[255,255,0],MAGENTA:[255,0,255],CYAN:[0,255,255]};var zb=1;xb.StandardOpacities={OPAQUE:zb,SEMI_HIGH:.75,SEMI_LOW:.25,TRANSPARENT:0};var Bb=[];
xb.EdgeStyles={NONE:Bb,RAISED:[[34,34,34,1,1,0],[34,34,34,2,2,0],[34,34,34,3,3,0]],DEPRESSED:[[204,204,204,1,1,0],[204,204,204,0,1,0],[34,34,34,-1,-1,0],[34,34,34,0,-1,0]],UNIFORM:[[34,34,34,0,0,4],[34,34,34,0,0,4],[34,34,34,0,0,4],[34,34,34,0,0,4]],DROP:[[34,34,34,2,2,3],[34,34,34,2,2,4],[34,34,34,2,2,5]]};function Eb(a,b){this.id=a;this.lang=b||"unknown";this.enabled=this.active=!1}n("shaka.player.TextTrack.compare",function(a,b){return a.lang<b.lang?-1:a.lang>b.lang?1:0});function Fb(a,b,c,d){this.id=a;this.bandwidth=b||0;this.width=c||0;this.height=d||0;this.active=!1}function Gb(a,b){var c=a.width*a.height,d=b.width*b.height;return c<d?-1:c>d?1:a.bandwidth<b.bandwidth?-1:a.bandwidth>b.bandwidth?1:0}n("shaka.player.VideoTrack.compare",Gb);function Hb(a,b,c){this.j=a;this.c=b;this.i=c;this.h=new Ka;this.b=[];this.u=0;this.f=this.a=null;this.l=0;H(this.h,this.c,"updateend",this.v.bind(this))}var Ib=1/60;Hb.prototype.destroy=function(){Jb(this);this.b=this.a=this.f=null;this.h.destroy();this.j=this.c=this.h=null};function Kb(a,b){for(var c=a.c.buffered,d=0;d<c.length;++d){var e=c.start(d)-Ib,f=c.end(d)+Ib;if(b>=e&&b<=f)return c.end(d)-b}return 0}
function Lb(a,b,c){if(a.a)return a=Error("Cannot fetch: previous operation not complete."),a.type="stream",Promise.reject(a);a.a=new lb;c&&mb(a.a,function(){return[Mb(this,c),this.g.bind(this)]}.bind(a));mb(a.a,function(){var a=b.a?b.a-b.b:1,c=new Nb;c.a=3;c.g=1E3*a;c.b=1E3*this.l;return[Ob(b.url,c,this.i),K.prototype.g.bind(b.url)]}.bind(a));mb(a.a,C(a,function(a){this.i.getBandwidth();return[Mb(this,a),this.g.bind(this)]}));var d=0==a.c.buffered.length&&0==a.b.length,e=null;mb(a.a,function(){if(d){var a=
b.b;e=this.c.buffered.start(0)-a}a=Pb(this.b,b.b);0<=a?this.b.splice(a+1,0,b):this.b.push(b)}.bind(a));return Qb(a).then(function(){return Promise.resolve(e)}.bind(a))}
function Rb(a){if(a.a)return a=Error("Cannot clear: previous operation not complete."),a.type="stream",Promise.reject(a);a.a=new lb;mb(a.a,function(){var a;a:if(0==this.c.buffered.length)a=Promise.resolve();else{try{this.c.remove(0,Number.POSITIVE_INFINITY)}catch(c){a=Promise.reject(c);break a}this.b=[];a=this.f=new B}return[a,this.g.bind(this)]}.bind(a));return Qb(a)}
function Sb(a,b){if(a.a){var c=Error("Cannot clearAfter: previous operation not complete.");c.type="stream";return Promise.reject(c)}a.a=new lb;mb(a.a,function(){return[Tb(this,b),this.g.bind(this)]}.bind(a));return Qb(a)}function Jb(a){a.a?(a=a.a,a.a?a=a.a:a.f?(a.c&&a.c(),a.a=new B,a=a.a):(a.f=!0,a=Promise.resolve())):a=Promise.resolve();return a}function Qb(a){a.a.start();return a.a.g.then(C(a,function(){this.a=null})).catch(C(a,function(a){this.a=null;return Promise.reject(a)}))}
function Mb(a,b){try{a.c.appendBuffer(b)}catch(c){return Promise.reject(c)}a.f=new B;return a.f}function Tb(a,b){if(0==a.c.buffered.length)return Promise.resolve();var c=Pb(a.b,b);if(-1==c||c==a.b.length-1)return Promise.resolve();try{a.c.remove(a.b[c+1].b,Number.POSITIVE_INFINITY)}catch(d){return Promise.reject(d)}a.b=a.b.slice(0,c+1);a.f=new B;return a.f}Hb.prototype.g=function(){"open"==this.j.readyState&&this.c.abort()};Hb.prototype.v=function(){this.f.resolve();this.f=null};function Ub(){var a=HTMLVideoElement.prototype;!a.getVideoPlaybackQuality&&"webkitDroppedFrameCount"in a&&(a.getVideoPlaybackQuality=Vb)}n("shaka.polyfill.VideoPlaybackQuality.install",Ub);function Vb(){return{droppedVideoFrames:this.webkitDroppedFrameCount,totalVideoFrames:this.webkitDecodedFrameCount,corruptedVideoFrames:0,creationTime:NaN,totalFrameDelay:0}};function Wb(){var a="CustomEvent"in window;if(a)try{new CustomEvent("")}catch(b){a=!1}a||(window.CustomEvent=Xb)}n("shaka.polyfill.CustomEvent.install",Wb);function Xb(a,b){var c=document.createEvent("CustomEvent"),d=b||{bubbles:!1,cancelable:!1,detail:null};c.initCustomEvent(a,!!d.bubbles,!!d.cancelable,d.detail);return c};function Yb(){return Promise.reject(Error("The key system specified is not supported."))}function Zb(a){return null==a?Promise.resolve():Promise.reject(Error("MediaKeys not supported."))}function $b(){throw new TypeError("Illegal constructor.");}$b.prototype.createSession=function(){};$b.prototype.setServerCertificate=function(){};function ac(){throw new TypeError("Illegal constructor.");}ac.prototype.getConfiguration=function(){};ac.prototype.createMediaKeys=function(){};function bc(){var a=Element.prototype;a.requestFullscreen=a.requestFullscreen||a.mozRequestFullScreen||a.msRequestFullscreen||a.webkitRequestFullscreen;a=Document.prototype;a.exitFullscreen=a.exitFullscreen||a.mozCancelFullScreen||a.msExitFullscreen||a.webkitExitFullscreen;"fullscreenElement"in document||Object.defineProperty(document,"fullscreenElement",{get:function(){return document.mozFullScreenElement||document.msFullscreenElement||document.webkitFullscreenElement}});document.addEventListener("webkitfullscreenchange",
cc);document.addEventListener("webkitfullscreenerror",cc);document.addEventListener("mozfullscreenchange",cc);document.addEventListener("mozfullscreenerror",cc);document.addEventListener("MSFullscreenChange",cc);document.addEventListener("MSFullscreenError",cc)}n("shaka.polyfill.Fullscreen.install",bc);function cc(a){var b=a.type.replace(/^(webkit|moz|MS)/,"").toLowerCase(),b=new Event(b,a);a.target.dispatchEvent(b)};function dc(a,b){try{var c=new ec(a,b);return Promise.resolve(c)}catch(d){return Promise.reject(d)}}function fc(a){var b=this.mediaKeys;b&&b!=a&&gc(b,null);delete this.mediaKeys;(this.mediaKeys=a)&&gc(a,this);return Promise.resolve()}
function ec(a,b){this.a=this.keySystem=a;var c=!0;"org.w3.clearkey"==a&&(this.a="webkit-org.w3.clearkey",c=!1);var d=!1,e;e=document.getElementsByTagName("video");e=e.length?e[0]:document.createElement("video");for(var f=0;f<b.length;++f){var g=b[f],h={audioCapabilities:[],videoCapabilities:[],persistentState:"optional",distinctiveIdentifier:"optional",initDataTypes:g.initDataTypes},l=!1;if(g.audioCapabilities)for(var m=0;m<g.audioCapabilities.length;++m){var t=g.audioCapabilities[m];t.contentType&&
(l=!0,e.canPlayType(t.contentType.split(";")[0],this.a)&&(h.audioCapabilities.push(t),d=!0))}if(g.videoCapabilities)for(m=0;m<g.videoCapabilities.length;++m)t=g.videoCapabilities[m],t.contentType&&(l=!0,e.canPlayType(t.contentType,this.a)&&(h.videoCapabilities.push(t),d=!0));l||(d=e.canPlayType("video/mp4",this.a)||e.canPlayType("video/webm",this.a));"required"==g.persistentState&&(c?h.persistentState="required":d=!1);if(d){this.b=h;return}}throw Error("None of the requested configurations were supported.");
}ec.prototype.createMediaKeys=function(){var a=new hc(this.a);return Promise.resolve(a)};ec.prototype.getConfiguration=function(){return this.b};function hc(a){this.g=a;this.b=null;this.a=new Ka;this.c=[];this.f={}}function gc(a,b){a.b=b;La(a.a);b&&(H(a.a,b,"webkitneedkey",a.vb.bind(a)),H(a.a,b,"webkitkeymessage",a.ub.bind(a)),H(a.a,b,"webkitkeyadded",a.sb.bind(a)),H(a.a,b,"webkitkeyerror",a.tb.bind(a)))}k=hc.prototype;
k.createSession=function(a){var b=a||"temporary";if("temporary"!=b&&"persistent-license"!=b)throw new TypeError("Session type "+a+" is unsupported on this platform.");a=this.b||document.createElement("video");a.src||(a.src="about:blank");b=new ic(a,this.g,b);this.c.push(b);return b};k.setServerCertificate=function(){return Promise.reject(Error("setServerCertificate not supported on this platform."))};k.vb=function(a){a=E({type:"encrypted",initDataType:"webm",initData:a.initData});this.b.dispatchEvent(a)};
k.ub=function(a){var b=jc(this,a.sessionId);b&&(a=E({type:"message",messageType:void 0==b.keyStatuses.a?"licenserequest":"licenserenewal",message:a.message}),b.b&&(b.b.resolve(),b.b=null),b.dispatchEvent(a))};k.sb=function(a){if(a=jc(this,a.sessionId))kc(a,"usable"),a.a&&a.a.resolve(),a.a=null};
k.tb=function(a){var b=jc(this,a.sessionId);if(b){var c=Error("EME v0.1b key error");c.errorCode=a.errorCode;c.errorCode.systemCode=a.systemCode;!a.sessionId&&b.b?(c.method="generateRequest",45==a.systemCode&&(c.message="Unsupported session type."),b.b.reject(c),b.b=null):a.sessionId&&b.a?(c.method="update",b.a.reject(c),b.a=null):(c=a.systemCode,a.errorCode.code==MediaKeyError.MEDIA_KEYERR_OUTPUT?kc(b,"output-not-allowed"):1==c?kc(b,"expired"):kc(b,"internal-error"))}};
function jc(a,b){var c=a.f[b];return c?c:(c=a.c.shift())?(c.sessionId=b,a.f[b]=c):null}function ic(a,b,c){y.call(this,null);this.f=a;this.h=!1;this.a=this.b=null;this.c=b;this.g=c;this.sessionId="";this.expiration=NaN;this.closed=new B;this.keyStatuses=new lc}p(ic,y);
function mc(a,b,c){if(a.h)return Promise.reject(Error("The session is already initialized."));a.h=!0;var d;try{if("persistent-license"==a.g)if(c)d=Da("LOAD_SESSION|"+c);else{var e=new Uint8Array(b);d=Da("PERSISTENT|"+Ca(e))}else d=new Uint8Array(b)}catch(f){return Promise.reject(f)}a.b=new B;try{a.f.webkitGenerateKeyRequest(a.c,d)}catch(g){if("InvalidStateError"!=g.name)return a.b=null,Promise.reject(g);setTimeout(function(){try{this.f.webkitGenerateKeyRequest(this.c,d)}catch(a){this.b.reject(a),
this.b=null}}.bind(a),10)}return a.b}k=ic.prototype;k.Da=function(a,b){if(this.a)this.a.then(this.Da.bind(this,a,b)).catch(this.Da.bind(this,a,b));else{this.a=a;var c,d;"webkit-org.w3.clearkey"==this.c?(c=Ca(new Uint8Array(b)),d=JSON.parse(c),"oct"!=d.keys[0].kty&&(this.a.reject(Error("Response is not a valid JSON Web Key Set.")),this.a=null),c=Fa(d.keys[0].k),d=Fa(d.keys[0].kid)):(c=new Uint8Array(b),d=null);try{this.f.webkitAddKey(this.c,c,d,this.sessionId)}catch(e){this.a.reject(e),this.a=null}}};
function kc(a,b){var c=a.keyStatuses;c.size=void 0==b?0:1;c.a=b;c=E({type:"keystatuseschange"});a.dispatchEvent(c)}k.generateRequest=function(a,b){return mc(this,b,null)};k.load=function(a){return"persistent-license"==this.g?mc(this,null,a):Promise.reject(Error("Not a persistent session."))};k.update=function(a){var b=new B;this.Da(b,a);return b};
k.close=function(){if("persistent-license"!=this.g){if(!this.sessionId)return this.closed.reject(Error("The session is not callable.")),this.closed;this.f.webkitCancelKeyRequest(this.c,this.sessionId)}this.closed.resolve();return this.closed};k.remove=function(){return"persistent-license"!=this.g?Promise.reject(Error("Not a persistent session.")):this.close()};function nc(a){this.b=a;this.a=0}
nc.prototype.next=function(){return this.a>=this.b.length?{value:void 0,done:!0}:{value:this.b[this.a++],done:!1}};function lc(){this.size=0;this.a=void 0}var pc;k=lc.prototype;k.entries=function(){var a=pc,b=[];this.a&&b.push([a,this.a]);return new nc(b)};k.forEach=function(a){this.a&&a(this.a)};k.get=function(a){if(this.has(a))return this.a};k.has=function(a){var b=pc;return this.a&&na(new Uint8Array(a),b)?!0:!1};k.keys=function(){var a=pc,b=[];this.a&&b.push(a);return new nc(b)};
k.values=function(){var a=[];this.a&&a.push(this.a);return new nc(a)};function qc(){Navigator.prototype.requestMediaKeySystemAccess&&MediaKeySystemAccess.prototype.getConfiguration||(HTMLMediaElement.prototype.webkitGenerateKeyRequest?(pc=new Uint8Array([0]),Navigator.prototype.requestMediaKeySystemAccess=dc,delete HTMLMediaElement.prototype.mediaKeys,HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=fc,window.MediaKeys=hc,window.MediaKeySystemAccess=ec):(Navigator.prototype.requestMediaKeySystemAccess=Yb,delete HTMLMediaElement.prototype.mediaKeys,
HTMLMediaElement.prototype.mediaKeys=null,HTMLMediaElement.prototype.setMediaKeys=Zb,window.MediaKeys=$b,window.MediaKeySystemAccess=ac))}n("shaka.polyfill.MediaKeys.install",qc);n("shaka.polyfill.installAll",function(){Wb();bc();qc();Ub()});var rc=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#(.*))?$/;function L(a){var b;a instanceof L?(sc(this,a.N),this.V=a.V,this.M=a.M,tc(this,a.aa),this.L=a.L,uc(this,a.a.clone()),this.T=a.T):a&&(b=String(a).match(rc))?(sc(this,b[1]||"",!0),this.V=vc(b[2]||""),this.M=vc(b[3]||"",!0),tc(this,b[4]),this.L=vc(b[5]||"",!0),uc(this,b[6]||"",!0),this.T=vc(b[7]||"")):this.a=new wc(null)}k=L.prototype;k.N="";k.V="";k.M="";k.aa=null;k.L="";k.T="";
k.toString=function(){var a=[],b=this.N;b&&a.push(xc(b,yc,!0),":");if(b=this.M){a.push("//");var c=this.V;c&&a.push(xc(c,yc,!0),"@");a.push(encodeURIComponent(b).replace(/%25([0-9a-fA-F]{2})/g,"%$1"));b=this.aa;null!=b&&a.push(":",String(b))}if(b=this.L)this.M&&"/"!=b.charAt(0)&&a.push("/"),a.push(xc(b,"/"==b.charAt(0)?zc:Ac,!0));(b=this.a.toString())&&a.push("?",b);(b=this.T)&&a.push("#",xc(b,Bc));return a.join("")};
k.resolve=function(a){var b=this.clone(),c=!!a.N;c?sc(b,a.N):c=!!a.V;c?b.V=a.V:c=!!a.M;c?b.M=a.M:c=null!=a.aa;var d=a.L;if(c)tc(b,a.aa);else if(c=!!a.L){if("/"!=d.charAt(0))if(this.M&&!this.L)d="/"+d;else{var e=b.L.lastIndexOf("/");-1!=e&&(d=b.L.substr(0,e+1)+d)}if(".."==d||"."==d)d="";else if(-1!=d.indexOf("./")||-1!=d.indexOf("/.")){for(var e=0==d.lastIndexOf("/",0),d=d.split("/"),f=[],g=0;g<d.length;){var h=d[g++];"."==h?e&&g==d.length&&f.push(""):".."==h?((1<f.length||1==f.length&&""!=f[0])&&
f.pop(),e&&g==d.length&&f.push("")):(f.push(h),e=!0)}d=f.join("/")}}c?b.L=d:c=""!==a.a.toString();c?uc(b,a.a.clone()):c=!!a.T;c&&(b.T=a.T);return b};k.clone=function(){return new L(this)};function sc(a,b,c){a.N=c?vc(b,!0):b;a.N&&(a.N=a.N.replace(/:$/,""))}function tc(a,b){if(b){b=Number(b);if(isNaN(b)||0>b)throw Error("Bad port number "+b);a.aa=b}else a.aa=null}function uc(a,b,c){b instanceof wc?a.a=b:(c||(b=xc(b,Cc)),a.a=new wc(b))}
function vc(a,b){return a?b?decodeURI(a):decodeURIComponent(a):""}function xc(a,b,c){return"string"==typeof a?(a=encodeURI(a).replace(b,Dc),c&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function Dc(a){a=a.charCodeAt(0);return"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var yc=/[#\/\?@]/g,Ac=/[\#\?:]/g,zc=/[\#\?]/g,Cc=/[\#\?@]/g,Bc=/#/g;function wc(a){this.b=a||null}wc.prototype.a=null;wc.prototype.c=null;
function Ec(a,b,c){if(!a.a&&(a.a={},a.c=0,a.b))for(var d=a.b.split("&"),e=0;e<d.length;e++){var f=d[e].indexOf("="),g=null,h=null;0<=f?(g=d[e].substring(0,f),h=d[e].substring(f+1)):g=d[e];g=decodeURIComponent(g.replace(/\+/g," "));h=h||"";Ec(a,g,decodeURIComponent(h.replace(/\+/g," ")))}a.b=null;(d=a.a.hasOwnProperty(b)&&a.a[b])||(a.a[b]=d=[]);d.push(c);a.c++}
wc.prototype.toString=function(){if(this.b)return this.b;if(!this.a)return"";var a=[],b;for(b in this.a)for(var c=encodeURIComponent(b),d=this.a[b],e=0;e<d.length;e++){var f=c;""!==d[e]&&(f+="="+encodeURIComponent(d[e]));a.push(f)}return this.b=a.join("&")};wc.prototype.clone=function(){var a=new wc;a.b=this.b;if(this.a){var b={},c;for(c in this.a)b[c]=this.a[c].concat();a.a=b;a.c=this.c}return a};function Fc(a,b){this.url=a;this.b=b||new Nb;this.g=this.j=this.h=0;this.a=null;this.c=new B;this.f=null}function Nb(){this.body=null;this.a=1;this.g=1E3;this.b=0;this.method="GET";this.f="arraybuffer";this.c={};this.j=this.h=!1}function Gc(a){Hc(a);a.b.body=null;a.c=null;a.f=null}function Hc(a){a.a&&(a.a.onload=null,a.a.onreadystatechange=null,a.a.onerror=null,a.a.ontimeout=null);a.a=null}k=Fc.prototype;
k.Va=function(){if(this.a)return this.c;if(0==this.url.lastIndexOf("data:",0)){var a=this.url.split(":")[1].split(";").pop().split(","),b=a.pop(),b="base64"==a.pop()?window.atob(b.replace(/-/g,"+").replace(/_/g,"/")):window.decodeURIComponent(b);"arraybuffer"==this.b.f&&(b=Da(b).buffer);a=JSON.parse(JSON.stringify(new XMLHttpRequest));a.response=b;a.responseText=b.toString();b=this.c;b.resolve(a);Gc(this);return b}if(0==this.url.lastIndexOf("idb:",0))return Ic(this);this.h++;this.j=Date.now();this.g||
(this.g=this.b.g);this.a=new XMLHttpRequest;a=this.url;this.f&&!this.f.supportsCaching()&&(a=new L(a),Ec(a.a,"_",Date.now()),a=a.toString());this.a.open(this.b.method,a,!0);this.a.responseType=this.b.f;this.a.timeout=this.b.b;this.a.withCredentials=this.b.h;this.a.onload=this.gb.bind(this);this.b.j&&(this.a.onreadystatechange=this.kb.bind(this));this.a.onerror=this.Bb.bind(this);this.a.ontimeout=this.ob.bind(this);for(b in this.b.c)this.a.setRequestHeader(b,this.b.c[b]);this.a.send(this.b.body);return this.c};
function Ic(a){var b=a.url.split("/"),c=parseInt(b[2],10),d=parseInt(b[3],10),e=new Va;return Oa(e).then(function(){return Za(e,c,d)}).then(C(a,function(a){var b=JSON.parse(JSON.stringify(new XMLHttpRequest));b.response=a;a=this.c;a.resolve(b);J(e);Gc(this);return a})).catch(C(a,function(a){J(e);Gc(this);return Promise.reject(a)}))}function Jc(a,b,c){b=Error(b);b.type=c;b.status=a.a.status;b.url=a.url;b.method=a.b.method;b.body=a.b.body;b.Fb=a.a;return b}
k.gb=function(a){this.f&&this.f.sample(Date.now()-this.j,a.loaded);200<=this.a.status&&299>=this.a.status?(this.c.resolve(this.a),Gc(this)):this.h<this.b.a?Kc(this):(a=Jc(this,"HTTP error.","net"),this.c.reject(a),Gc(this))};k.kb=function(){if(this.a.readyState==XMLHttpRequest.HEADERS_RECEIVED){var a=Date.parse(this.a.getResponseHeader("Date"));a&&(kb=a-Date.now())}};k.Bb=function(){var a=Jc(this,"Network failure.","net");this.c.reject(a);Gc(this)};
k.ob=function(){if(this.h<this.b.a)Kc(this);else{var a=Jc(this,"Request timed out.","net");this.c.reject(a);Gc(this)}};function Kc(a){Hc(a);window.setTimeout(a.Va.bind(a),a.g*(1+.5*(2*Math.random()-1)));a.g*=2};function K(a,b,c){this.c=a;this.f=b||0;this.h=null!=c?c:null;this.b=this.a=null}function Lc(a,b){return a&&0!==a.length?a.map(function(a){return a.resolve(b)}):[b]}function Ob(a,b,c){if(a.a)return a.a;b=b||new Nb;if(a.f||a.h)b.c.Range="bytes="+(a.f+"-"+(null!=a.h?a.h:""));a.a=Mc(a,0,b,c);return a.a}K.prototype.g=function(){if(this.b){this.a=null;var a=this.b;if(a.a&&a.a.readyState!=XMLHttpRequest.DONE){a.a.abort();var b=Jc(a,"Request aborted.","aborted");a.c.reject(b);Gc(a)}this.b=null}};
function Mc(a,b,c,d){a.b=new Fc(a.c[b].toString(),c);d&&(a.b.f=d);var e=a.b.Va().then(C(a,function(a){this.b=null;return Promise.resolve(a.response)}));return e=e.catch(C(a,function(a){if(this.a&&b+1<this.c.length)return this.a=Mc(this,b+1,c,d);this.a=this.b=null;return Promise.reject(a)}))}K.prototype.clone=function(){return new K(this.c.map(function(a){return a.clone()}),this.f,this.h)};function Nc(a,b,c,d,e,f){this.b=new K([new L(a)]);this.a=new Nb;this.a.body=b;this.a.method=c;this.a.a=3;this.a.h=d;this.a.b=1E3*(null!=f?f:0);a=e||{};for(var g in a)this.a.c[g]=a[g]}function Oc(a){return Ob(a.b,a.a).then(function(a){return Promise.resolve(new Uint8Array(a))})};function Pc(){this.id=this.url=null;this.type="static";this.c=this.i=this.m=null;this.h=5;this.f=this.b=this.g=null;this.j=1;this.a=[]}function Qc(){this.g=this.f=this.c=this.m=this.a=this.start=this.id=null;this.b=[]}function Rc(){this.i=this.b=this.height=this.width=this.contentType=this.lang=this.c=this.id=null;this.f=!1;this.j=this.h=this.g=this.m=null;this.l=[];this.a=[]}function Sc(){this.value=null}function Tc(){this.contentType=this.lang=this.id=null}
function Uc(){this.a=this.b=this.f=this.m=this.h=this.c=this.height=this.width=this.bandwidth=this.lang=this.id=null;this.g=[]}function Vc(){this.value=this.schemeIdUri=null;this.children=[];this.pssh=null}function Wc(){this.parsedPssh=this.psshBox=null}function Xc(){this.url=null}function Yc(){this.url=null}function Zc(){this.m=null;this.g=1;this.c=this.b=this.a=this.f=null}Zc.prototype.clone=function(){var a=new Zc;a.m=$c(this.m);a.g=this.g;a.f=this.f;a.a=M(this.a);a.b=M(this.b);a.c=M(this.c);return a};
function ad(){this.a=this.url=null}ad.prototype.clone=function(){var a=new ad;a.url=$c(this.url);a.a=M(this.a);return a};function bd(){this.a=this.url=null}bd.prototype.clone=function(){var a=new bd;a.url=$c(this.url);a.a=M(this.a);return a};function cd(){this.m=null;this.f=1;this.b=this.j=null;this.h=1;this.g=null;this.a=[];this.c=null}cd.prototype.clone=function(){var a=new cd;a.m=$c(this.m);a.f=this.f;a.j=this.j;a.b=this.b;a.h=this.h;a.g=M(this.g);a.a=$c(this.a)||[];a.c=M(this.c);return a};
function dd(){this.a=this.b=null}dd.prototype.clone=function(){var a=new dd;a.b=$c(this.b);a.a=M(this.a);return a};function ed(){this.b=1;this.a=this.i=null;this.j=1;this.c=this.g=this.f=this.h=null}ed.prototype.clone=function(){var a=new ed;a.b=this.b;a.i=this.i;a.a=this.a;a.j=this.j;a.h=this.h;a.f=this.f;a.g=this.g;a.c=M(this.c);return a};function fd(){this.a=[]}fd.prototype.clone=function(){var a=new fd;a.a=$c(this.a)||[];return a};function gd(){this.b=this.a=this.c=null}
gd.prototype.clone=function(){var a=new gd;a.c=this.c;a.a=this.a;a.b=this.b;return a};function hd(a,b){this.ha=a;this.end=b}hd.prototype.clone=function(){return new hd(this.ha,this.end)};Pc.TAG_NAME="MPD";Qc.TAG_NAME="Period";Rc.TAG_NAME="AdaptationSet";Sc.TAG_NAME="Role";Tc.TAG_NAME="ContentComponent";Uc.TAG_NAME="Representation";Vc.TAG_NAME="ContentProtection";Wc.TAG_NAME="cenc:pssh";Xc.TAG_NAME="BaseURL";Yc.TAG_NAME="Location";Zc.TAG_NAME="SegmentBase";ad.TAG_NAME="RepresentationIndex";
bd.TAG_NAME="Initialization";cd.TAG_NAME="SegmentList";dd.TAG_NAME="SegmentURL";ed.TAG_NAME="SegmentTemplate";fd.TAG_NAME="SegmentTimeline";gd.TAG_NAME="S";
Pc.prototype.parse=function(a,b){this.url=a.m;this.id=N(b,"id",O);this.type=N(b,"type",O)||"static";this.c=N(b,"mediaPresentationDuration",id);this.h=N(b,"minBufferTime",id,this.h);this.g=N(b,"minimumUpdatePeriod",id,this.g);this.b=N(b,"availabilityStartTime",jd,this.b);this.f=N(b,"timeShiftBufferDepth",id,this.f);this.j=N(b,"suggestedPresentationDelay",id,this.j);var c=a.m,d=P(this,b,Xc);this.m=kd(c,d);if(d=Q(this,b,Yc))this.i=ld(c,d.url);this.a=P(this,b,Qc)};
Qc.prototype.parse=function(a,b){this.id=N(b,"id",O);this.start=N(b,"start",id);this.a=N(b,"duration",id);var c=P(this,b,Xc);this.m=kd(a.m,c);this.c=Q(this,b,Zc);this.f=Q(this,b,cd);this.g=Q(this,b,ed);this.b=P(this,b,Rc);md(this)};function md(a){for(var b=[],c=0;c<a.b.length;++c){var d=a.b[c];null!=d.c&&(b[d.c]=!0)}for(c=0;c<a.b.length;++c)if(d=a.b[c],null==d.c){for(var e=1;1==b[e];)++e;b[e]=!0;d.c=e}}
Rc.prototype.parse=function(a,b){var c=Q(this,b,Tc)||{},d=Q(this,b,Sc);this.id=N(b,"id",O);this.c=N(b,"group",R);this.lang=N(b,"lang",O,c.lang);this.contentType=N(b,"contentType",O,c.contentType);this.width=N(b,"width",nd);this.height=N(b,"height",nd);this.b=N(b,"mimeType",O);this.i=N(b,"codecs",O);this.f=d&&"main"==d.value;this.lang&&(this.lang=fb(this.lang));c=P(this,b,Xc);this.m=kd(a.m,c);this.l=P(this,b,Vc);!this.contentType&&this.b&&(this.contentType=this.b.split("/")[0]);this.g=a.c?od(this,
b,a.c):Q(this,b,Zc);this.h=a.f?od(this,b,a.f):Q(this,b,cd);this.j=a.g?od(this,b,a.g):Q(this,b,ed);this.a=P(this,b,Uc);!this.b&&this.a.length&&(this.b=this.a[0].c,!this.contentType&&this.b&&(this.contentType=this.b.split("/")[0]))};Sc.prototype.parse=function(a,b){this.value=N(b,"value",O)};Tc.prototype.parse=function(a,b){this.id=N(b,"id",O);this.lang=N(b,"lang",O);this.contentType=N(b,"contentType",O);this.lang&&(this.lang=fb(this.lang))};
Uc.prototype.parse=function(a,b){this.id=N(b,"id",O);this.bandwidth=N(b,"bandwidth",nd);this.width=N(b,"width",nd,a.width);this.height=N(b,"height",nd,a.height);this.c=N(b,"mimeType",O,a.b);this.h=N(b,"codecs",O,a.i);this.lang=a.lang;var c=P(this,b,Xc);this.m=kd(a.m,c);this.g=P(this,b,Vc);this.f=a.g?od(this,b,a.g):Q(this,b,Zc);this.b=a.h?od(this,b,a.h):Q(this,b,cd);this.a=a.j?od(this,b,a.j):Q(this,b,ed);0==this.g.length&&(this.g=a.l)};
Vc.prototype.parse=function(a,b){this.schemeIdUri=N(b,"schemeIdUri",O);this.value=N(b,"value",O);this.pssh=Q(this,b,Wc);this.children=Array.prototype.slice.call(b.childNodes)};Wc.prototype.parse=function(a,b){var c=pd(b);if(c){this.psshBox=Fa(c);try{this.parsedPssh=new Ha(this.psshBox)}catch(d){if(!(d instanceof RangeError))throw d;}}};Xc.prototype.parse=function(a,b){this.url=pd(b)};Yc.prototype.parse=function(a,b){this.url=pd(b)};
Zc.prototype.parse=function(a,b){this.m=a.m||this.m;this.g=N(b,"timescale",nd,this.g);this.f=N(b,"presentationTimeOffset",R,this.f);this.a=N(b,"indexRange",qd,this.a);this.b=Q(this,b,ad)||this.b;this.c=Q(this,b,bd)||this.c};ad.prototype.parse=function(a,b){var c=N(b,"sourceURL",O);this.url=ld(a.m,c);this.a=N(b,"range",qd,M(a.a))};bd.prototype.parse=function(a,b){var c=N(b,"sourceURL",O);this.url=ld(a.m,c);this.a=N(b,"range",qd)};
cd.prototype.parse=function(a,b){this.m=a.m||this.m;this.f=N(b,"timescale",nd,this.f);this.j=N(b,"presentationTimeOffset",R,this.j);this.b=N(b,"duration",nd,this.b);this.h=N(b,"startNumber",R,this.h);this.g=Q(this,b,bd)||this.g;var c=P(this,b,dd);this.a=c&&0<c.length?c:this.a;this.c=Q(this,b,fd)||this.c};dd.prototype.parse=function(a,b){var c=N(b,"media",O);this.b=ld(a.m,c);this.a=N(b,"mediaRange",qd)};
ed.prototype.parse=function(a,b){this.b=N(b,"timescale",nd,this.b);this.i=N(b,"presentationTimeOffset",R,this.i);this.a=N(b,"duration",nd,this.a);this.j=N(b,"startNumber",R,this.j);this.h=N(b,"media",O,this.h);this.f=N(b,"index",O,this.f);this.g=N(b,"initialization",O,this.g);this.c=Q(this,b,fd)||this.c};fd.prototype.parse=function(a,b){this.a=P(this,b,gd)};gd.prototype.parse=function(a,b){this.c=N(b,"t",R);this.a=N(b,"d",R);this.b=N(b,"r",R)};
function kd(a,b){if(!b||0===b.length)return a;for(var c=[],d=0;d<b.length;d++){var e=b[d].url;null==a||0===a.length?c.push(new L(e)):(e=ld(a.slice(0,1),e),c.push(e[0]))}return c}function ld(a,b){if(!b)return a;var c=new L(b);return a?a.map(function(a){return a.resolve(c)}):[c]}function od(a,b,c){var d=M(c);(b=rd(b,c.constructor.TAG_NAME))&&d.parse(a,b);return d}function Q(a,b,c){var d=null;if(b=rd(b,c.TAG_NAME))d=new c,d.parse(a,b);return d}
function rd(a,b){for(var c=null,d=0;d<a.childNodes.length;d++)if(a.childNodes[d].tagName==b){if(c)return null;c=a.childNodes[d]}return c}function P(a,b,c){for(var d=[],e=0;e<b.childNodes.length;e++)if(b.childNodes[e].tagName==c.TAG_NAME){var f=new c;f.parse.call(f,a,b.childNodes[e]);d.push(f)}return d}function pd(a){a=a.firstChild;return a.nodeType!=Node.TEXT_NODE?null:a.nodeValue}function $c(a){return a?a.map(function(a){return a.clone()}):null}function M(a){return a?a.clone():null}
function N(a,b,c,d){a=c(a.getAttribute(b));return null!=a?a:void 0!==d?d:null}function jd(a){if(!a)return null;a=Date.parse(a);return isNaN(a)?null:Math.floor(a/1E3)}
function id(a){if(!a)return null;var b=/^P(?:([0-9]*)Y)?(?:([0-9]*)M)?(?:([0-9]*)D)?(?:T(?:([0-9]*)H)?(?:([0-9]*)M)?(?:([0-9.]*)S)?)?$/.exec(a);if(!b)return null;a=0;var c=R(b[1]);c&&(a+=31536E3*c);(c=R(b[2]))&&(a+=2592E3*c);(c=R(b[3]))&&(a+=86400*c);(c=R(b[4]))&&(a+=3600*c);(c=R(b[5]))&&(a+=60*c);b=window.parseFloat(b[6]);(b=isNaN(b)?null:b)&&(a+=b);return a}
function qd(a){var b=/([0-9]+)-([0-9]+)/.exec(a);if(!b)return null;a=R(b[1]);if(null==a)return null;b=R(b[2]);return null==b?null:new hd(a,b)}function nd(a){a=window.parseInt(a,10);return 0<a?a:null}function R(a){a=window.parseInt(a,10);return 0<=a?a:null}function O(a){return a};function sd(a,b){this.a=new Nb;this.a.f="text";this.a.a=3;this.a.b=1E3*(null!=b?b:0);this.a.j=!0;this.b=a}function td(a){var b=a.b;return Ob(b,a.a).then(function(a){var d;d=b.c;d=(a=(new DOMParser).parseFromString(a,"text/xml"))?Q({m:d},a,Pc):null;if(d)return Promise.resolve(d);d=Error("MPD parse failure.");d.type="mpd";return Promise.reject(d)})};function ud(a,b,c){for(var d=a.a,e=[],f=0;f<c;++f){var g=f+b,h=(g-1)*d.a,l=h/d.b,h=(h+d.a)/d.b,g=vd(a,g-1+d.j,(g-1)*d.a);if(!g)return null;e.push(new S(l,h,g))}return e}function vd(a,b,c){if(!a.a)return null;var d=a.a.h;if(!d)return a.m?new K(a.m,0,null):null;b=wd(d,a.id,b,a.bandwidth,c);if(!b)return null;a=Lc(a.m,b);return new K(a,0,null)}
function wd(a,b,c,d,e){var f={RepresentationID:b,Number:c,Bandwidth:d,Time:e};a=a.replace(/\$(RepresentationID|Number|Bandwidth|Time)?(?:%0([0-9]+)d)?\$/g,function(a,b,c){if("$$"==a)return"$";var d=f[b];if(null==d)return a;"RepresentationID"==b&&c&&(c=void 0);a=d.toString();c=window.parseInt(c,10)||1;c=Math.max(0,c-a.length);return Array(c+1).join("0")+a});try{return new L(a)}catch(g){if(g instanceof URIError)return null;throw g;}}
function xd(a){var b=0;a=a.a;for(var c=[],d=0;d<a.length&&a[d].a;++d)for(var e=a[d].c,e=null!=e?e:b,f=a[d].b||0,g=0;g<=f;++g){var h=e+a[d].a;0<c.length&&e!=b&&(c[c.length-1].end=e);c.push({start:e,end:h});b=e=h}return c};function yd(a){this.a=a}yd.prototype.destroy=function(){this.a&&(this.a.g(),this.a=null)};yd.prototype.create=function(){return this.a?Ob(this.a):Promise.resolve(null)};function S(a,b,c){this.b=a;this.a=b;this.url=c}function Pb(a,b){for(var c=a.length-1;0<=c;--c){var d=a[c];if(b>=d.b&&(null==d.a||b<d.a))return c}return-1}function zd(a,b){return a.map(function(a){return new S(a.b+b,null!=a.a?a.a+b:null,a.url)})};function Ad(){}
Ad.prototype.parse=function(a,b,c){var d=null;try{var e;var f=new ia(b);if(440786851!=la(f).id)e=null;else{var g=la(f);if(408125543!=g.id)e=null;else{var h=g.a.byteOffset,l;var m=new ia(g.a);for(b=null;za(m.a);){var t=la(m);if(357149030==t.id){b=t;break}}if(b){for(var q=new ia(b.a),m=1E6;za(q.a);){var D=la(q);if(2807729==D.id){m=ra(D);break}}l=m/1E9}else l=null;e=l?{xb:h,Cb:l}:null}}if(e){var w=la(new ia(a));if(475249515!=w.id)d=null;else{var r=e.xb,A=e.Cb;a=[];var F=new ia(w.a);for(e=w=-1;za(F.a);){var u=
la(F);if(187==u.id){var x;var I=new ia(u.a),wa=la(I);if(179!=wa.id)x=null;else{var Qe=ra(wa),Fd=la(I);if(183!=Fd.id)x=null;else{for(var Gd=new ia(Fd.a),h=0;za(Gd.a);){var Hd=la(Gd);if(241==Hd.id){h=ra(Hd);break}}x={Eb:Qe,wb:h}}}if(x){var Id=A*x.Eb,Jd=r+x.wb;if(0<=w){var oc=new K(c,e,Jd-1);a.push(new S(w,Id,oc))}w=Id;e=Jd}}}0<=w&&(oc=new K(c,e,null),a.push(new S(w,null,oc)));d=a}}else d=null}catch(Kd){if(!(Kd instanceof RangeError))throw Kd;}return d};function T(a){this.s=a;this.g=0}T.prototype.destroy=function(){this.s=null};k=T.prototype;k.length=function(){return this.s.length};function U(a){if(0==a.s.length)throw new RangeError("SegmentIndex: There is no first SegmentReference.");return a.s[0]}function V(a){if(0==a.s.length)throw new RangeError("SegmentIndex: There is no last SegmentReference.");return a.s[a.s.length-1]}k.get=function(a){if(0>a||a>=this.s.length)throw new RangeError("SegmentIndex: The specified index is out of range.");return this.s[a]};
k.da=function(a){a=Pb(this.s,a);return 0<=a?this.s[a]:null};k.xa=function(a){Bd(this,a);return!0};
function Bd(a,b){a.g!=b.g&&(b=new T(zd(b.s,a.g-b.g)));if(0==a.length())a.s=b.s.slice(0);else if(0!=b.length()&&null!=V(a).a&&!(null!=V(b).a&&V(b).a<V(a).a)){if(V(a).a<=U(b).b){var c,d=V(a);c=V(a).b;var e=U(b).b;c=new S(c,e,d.url);d=a.s.slice(0,-1).concat([c])}else{for(d=0;d<a.s.length&&!(a.s[d].a>=U(b).b);++d);a.s[d].b<U(b).b?(c=U(b).b,c=new S(a.s[d].b,c,a.s[d].url),d=a.s.slice(0,d).concat([c])):(U(a).b>U(b).b||U(b),d=a.s.slice(0,d))}a.s=d.concat(b.s)}}
k.ca=function(a){var b=a-this.g;if(0==b)return 0;this.s=zd(this.s,b);this.g=a;return b};k.wa=function(){return 0<this.length()?{start:U(this).b,end:V(this).a}:{start:0,end:0}};function W(a,b,c,d){T.call(this,a);this.f=b;this.v=c;this.l=d;this.c=this.i=this.a=null;Cd(this)}p(W,T);W.prototype.destroy=function(){this.v=this.f=null;T.prototype.destroy.call(this)};W.prototype.da=function(a){Dd(this,jb()/1E3);return T.prototype.da.call(this,a)};W.prototype.xa=function(a){Bd(this,a);null==this.a&&Cd(this);return!0};
function Cd(a){if(0!=a.length()){a.length();var b=null!=V(a).a?V(a).a:V(a).b;if(a.f.b>a.l)a.a=b;else{var c=a.l-(a.f.b+a.v.start);0>c?a.a=b:c<Math.max(V(a).b,V(a).a||0)?(V(a),a.a=b):a.a=c}a.i=V(a).b;a.c=U(a).b}}W.prototype.ca=function(a){a=T.prototype.ca.call(this,a);null!=this.a&&(this.i+=a,this.c+=a,this.i>this.a&&(this.a+=a));return a};W.prototype.wa=function(){return Ed(this,jb()/1E3)};
function Ed(a,b){Dd(a,b);if(null==a.a||null==a.i||null==a.c)return{start:0,end:0};var c=b-a.l,d=a.a+c;null!=a.f.f&&(d=d-a.c-a.f.f,0<d&&(a.c+=d));c=a.i+c;c=0<a.length()?null!=V(a).a?Math.min(c,V(a).a):c:a.c;c=Math.max(c,a.c);return{start:a.c,end:c}}function Dd(a,b){if(null!=a.f.f)if(null==a.a)a.length();else{for(var c=a.a+(b-a.l),d=0,e=0;e<a.s.length;++e){var f=null;e<a.s.length-1?f=a.s[e+1].a:(f=a.s[e],f=null!=f.a?f.a+(f.a-f.b):null);if(null!=f&&f<c-a.f.f)++d;else break}0<d&&a.s.splice(0,d)}};function Ld(a,b,c,d){var e=1,f=0,g;if(a.b>d)g=null;else{var h=a.j||0,l=a.f||0;g=c.a;g=g.a/g.b;var m=d-(a.b+b.start);0>m?g=null:(l=m-2*g-l,0>l&&(l=0),l=Math.ceil(l/g)*g,m-=g,0>m?g=null:(h=Math.floor(m/g)*g-h,0>h&&(h=0),h=Math.floor(h/g)*g,g={Ha:l/g+1,current:(h>=l?h:l)/g+1}))}g&&(e=g.Ha,f=g.current-g.Ha+1);e=ud(c,e,f);if(null==e)throw a=Error("Failed to generate SegmentReferences."),a.type="stream",a;W.call(this,e,a,b,d);this.u=c;this.j=this.b=0<this.length()?a.b+b.start+V(this).a:null;this.h=g?g.current+
1:null}p(Ld,W);Ld.prototype.destroy=function(){this.u=null;W.prototype.destroy.call(this)};Ld.prototype.da=function(a){var b=jb()/1E3;Md(this,b);Dd(this,b);return T.prototype.da.call(this,a)};Ld.prototype.xa=function(a){if(null!=this.b||!(a instanceof Ld)||null==a.b)return!1;this.b=a.b;this.j=a.j;this.h=a.h;Bd(this,a);Md(this,jb()/1E3);Cd(this);return!0};Ld.prototype.ca=function(a){a=W.prototype.ca.call(this,a);null!=this.b&&(this.b+=a,this.j+=a);return a};
Ld.prototype.wa=function(){var a=jb()/1E3;Md(this,a);return Ed(this,a)};function Md(a,b){if(null!=a.b&&null!=a.j&&null!=a.h){var c=a.u.a,c=c.a/c.b,d=Math.floor((a.j+(b-a.l)-a.b)/c);if(0!=d){var e=ud(a.u,a.h,d);Array.prototype.push.apply(a.s,zd(e,a.g));a.b+=d*c;a.h+=d}}};function Nd(a,b,c,d){this.b=a;this.f=b;this.c=c;this.g=d;this.a=null}Nd.prototype.destroy=function(){this.c=this.f=this.b=null;this.a&&(this.a.destroy(),this.a=null)};
Nd.prototype.create=function(){if(this.a)return Promise.resolve(this.a);for(var a=this.c.a,b=xd(a.c),c=[],d=0;d<b.length;++d){var e=b[d].start,f=e/a.b,g=b[d].end/a.b,e=vd(this.c,d+a.j,e);if(!e)return a=Error("Failed to generate media URL."),a.type="dash",Promise.reject(a);c.push(new S(f,g,e))}this.a="dynamic"==this.b.type?new W(c,this.b,this.f,this.g):new T(c);return Promise.resolve(this.a)};function Od(a,b,c,d){this.b=a;this.c=b;this.f=c;this.a=null;this.g=d}Od.prototype.destroy=function(){this.f=this.c=this.b=null;this.a&&(this.a.destroy(),this.a=null)};
Od.prototype.create=function(){if(this.a)return Promise.resolve(this.a);var a=this.f.b,b=[];a.c&&(b=xd(a.c));var c=0;a.b&&a.h?c=a.b*a.h:0<b.length&&(c=b[0].start);var d=[],e=a.a.length;0<b.length&&b.length!=a.a.length&&(e=Math.min(b.length,a.a.length));for(var f=0;f<e;++f){var g=a.a[f],h=null,l=null,m=c/a.f;a.b?(h=c+a.b,l=h/a.f):0<b.length?(h=b[f].end,l=h/a.f):(l=m+this.c.a,h=l*a.f);var c=h,h=0,t=null;g.a&&(h=g.a.ha,t=g.a.end);d.push(new S(m,l,new K(g.b,h,t)))}this.a="dynamic"==this.b.type?new W(d,
this.b,this.c,this.g):new T(d);return Promise.resolve(this.a)};function Pd(a,b,c,d){this.c=a;this.f=b;this.b=c;this.g=d;this.a=null}Pd.prototype.destroy=function(){this.b=this.f=this.c=null;this.a&&(this.a.destroy(),this.a=null)};
Pd.prototype.create=function(){if(this.a)return Promise.resolve(this.a);if("dynamic"==this.c.type)try{this.a=new Ld(this.c,this.f,this.b,this.g)}catch(a){return Promise.reject(a)}else{var b=this.b.a,b=ud(this.b,1,Math.ceil(this.f.a/(b.a/b.b)));if(!b)return b=Error("Failed to generate SegmentReferences"),b.type="stream",Promise.reject(b);this.a=new T(b)}return Promise.resolve(this.a)};function Qd(a){this.b=a;this.a=null}Qd.prototype.destroy=function(){this.b=null;this.a&&(this.a.destroy(),this.a=null)};Qd.prototype.create=function(){if(this.a)return Promise.resolve(this.a);for(var a=[],b=0;b<this.b.length;++b){var c=this.b[b];a.push(new S(c.start_time,c.end_time,new K([new L(c.url)],c.start_byte,null)))}this.b=null;this.a=new T(a);return Promise.resolve(this.a)};function Rd(){}
Rd.prototype.parse=function(a,b,c){var d=null;try{a:{var e=[],f=new ja(a),g=z(f);if(1936286840!=z(f))d=null;else{1==g&&(g=Aa(f));var h=qa(f);oa(f,3);oa(f,4);var l=z(f);if(0==l)d=null;else{var m,t;0==h?(m=z(f),t=z(f)):(m=Aa(f),t=Aa(f));oa(f,2);var q=f.b.getUint16(f.a,f.c);f.a+=2;a=m;b=b+g+t;for(g=0;g<q;g++){var D=z(f);t=(D&2147483648)>>>31;var h=D&2147483647,w=z(f);z(f);if(1==t){d=null;break a}var r=new K(c,b,b+h-1);e.push(new S(a/l,(a+w)/l,r));a+=w;b+=h}d=e}}}}catch(A){if(!(A instanceof RangeError))throw A;
}return d};function Sd(a,b,c,d,e,f){this.g=a;this.j=b;this.c=c;this.a=d;this.f=e;this.i=f;this.h=this.b=null}Sd.prototype.destroy=function(){this.j=this.g=null;this.a.g();this.a=null;this.f&&(this.f.g(),this.f=null);this.h&&(this.h.destroy(),this.h=null);this.b=null};
Sd.prototype.create=function(){if(this.b)return this.b;var a=[Ob(this.a)];"webm"==this.c&&a.push(Ob(this.f));return this.b=Promise.all(a).then(C(this,function(a){var c=a[0];a=a[1]||null;var d=null;"mp4"==this.c?(d=new Rd,d=d.parse(new DataView(c),this.a.f,this.a.c)):"webm"==this.c&&(d=new Ad,d=d.parse(new DataView(c),new DataView(a),this.a.c));if(!d)return c=Error("Failed to parse segment references from",this.c,"container."),c.type="stream",Promise.reject(c);c="dynamic"==this.g.type?new W(d,this.g,
this.j,this.i):new T(d);return Promise.resolve(c)}))};function Td(){this.B=Ud++;this.id=this.A=this.C=null;this.c=0;this.height=this.width=this.bandwidth=null;this.b=this.a="";this.enabled=!0}var Ud=0;Td.prototype.destroy=function(){this.C&&(this.C.destroy(),this.C=null);this.A&&(this.A.destroy(),this.A=null)};function Vd(a){var b=a.a||"";a.b&&(b+='; codecs="'+a.b+'"');return b}function Wd(){this.B=Xd++;this.id=null;this.contentType=this.lang="";this.b=!1;this.o=[];this.a=[]}var Xd=0;
Wd.prototype.destroy=function(){for(var a=0;a<this.o.length;++a)this.o[a].destroy();this.a=this.o=null};function Yd(a){for(var b=[],c=0;c<a.a.length;++c){var d=new Zd;d.id=a.B;d.a=a.a[c];d.contentType=a.contentType;d.b=a.o.length?Vd(a.o[0]):"";b.push(d)}return b}function $d(){this.id=null;this.start=0;this.b=null;this.a=[]}$d.prototype.destroy=function(){for(var a=0;a<this.a.length;++a)this.a[a].destroy();this.a=null};function ae(){this.b=!1;this.g=this.f=null;this.c=0;this.a=[]}
ae.prototype.destroy=function(){for(var a=0;a<this.a.length;++a)this.a[a].destroy();this.a=null};function Zd(){this.id=0;this.a=null;this.b=this.contentType=""};function be(a,b){Na.call(this,"readwrite",b);this.l=a;this.b=0}p(be,Na);
function ce(a,b,c,d,e){for(var f=[],g=[],h=0,l=0,m=[],t=b.map(function(a){return a.C.create()}),t=Promise.all(t),q=b.map(function(a){return a.A.create()}),q=Promise.all(q),t=Promise.all([t,q]).then(function(a){f=a[0];g=a[1];h=f.reduce(function(a,b){return a+b.length()},0)}),q=0;q<b.length;++q)t=t.then(function(a){return de(this,b[a],f[a],g[a],h,l)}.bind(a,q)),t=t.then(function(a,b){l+=f[a].length();m.push(b)}.bind(a,q));return t.then(C(a,function(){return ee(Ta(this))})).then(C(a,function(a){var b=
new B,f={group_id:a,stream_ids:m,session_ids:c,duration:d,key_system:e.b},g=Ta(this).put(f);g.onsuccess=function(){b.resolve(a)};g.onerror=function(){b.reject(g.error)};return b}))}function fe(a,b){return Ua(Ta(a),b).then(C(a,function(a){var d=[],e;for(e in a.stream_ids)d.push(ge(this,a.stream_ids[e]));a=Ta(this);d.push(a.delete(b));return Promise.all(d)}))}
function de(a,b,c,d,e,f){var g=[ee(Sa(a)),ee(Qa(a).index("stream"))],g=Promise.all(g).then(C(a,function(a){return{ka:Math.max(a[0],a[1]),ba:new ArrayBuffer(0),ya:0,s:[],ua:null,Db:e,Oa:f}})),g=g.then(a.f.bind(a,c));return g=g.then(a.g.bind(a,b,d))}function ee(a){var b=new B,c=a.openCursor(null,"prev");c.onsuccess=function(a){a.target.result?b.resolve(a.target.result.key+1):b.resolve(0)};c.onerror=function(){b.reject(c.error)};return b}
be.prototype.g=function(a,b,c){var d=new B;a={stream_id:c.ka,mime_type:a.a,codecs:a.b,init_segment:b,references:c.s};var e=Sa(this).put(a);e.onsuccess=function(){d.resolve(c.ka)};e.onerror=function(){d.reject(e.error)};return d};be.prototype.f=function(a,b){for(var c=Promise.resolve(),d=0;d<a.length();++d)var e=a.get(d),f=this.c.bind(this,e,b),c=c.then(this.i.bind(this,e)),c=c.then(f);return c.then(function(){return Promise.resolve(b)}).catch(C(this,function(a){ge(this,b.ka);return Promise.reject(a)}))};
be.prototype.c=function(a,b,c){var d=new B;0==b.ba.byteLength&&(b.ua=a);b.ba=he(b.ba,c);b.Oa++;var e=E({type:"progress",detail:b.Oa/b.Db*100,bubbles:!0});if(1048576<=b.ba.byteLength||null==a.a){c={stream_id:b.ka,segment_id:b.ya,content:b.ba};var f=Qa(this).put(c);b.s.push({start_time:b.ua.b,start_byte:b.ua.url.f,end_time:a.a,url:"idb://"+b.ka+"/"+b.ya});b.ya++;b.ba=new ArrayBuffer(0);f.onerror=function(){d.reject(f.error)};f.onsuccess=C(this,function(){this.dispatchEvent(e);d.resolve()})}else this.dispatchEvent(e),
d.resolve();return d};function he(a,b){var c=new Uint8Array(a.byteLength+b.byteLength);c.set(new Uint8Array(a),0);c.set(new Uint8Array(b),a.byteLength);return c.buffer}be.prototype.i=function(a){var b=new Nb;b.b=1E3*this.b;return Ob(a.url,b,this.l)};
function ge(a,b){var c=new B,d=Sa(a).delete(b);d.onerror=function(){c.reject(d.error)};var e=Qa(a);e.index("stream").openKeyCursor(IDBKeyRange.only(b)).onsuccess=function(a){if(a=a.target.result)e.delete(a.primaryKey),a.continue()};e.transaction.oncomplete=function(){c.resolve()};return c};function ie(){this.streamStats=null;this.droppedFrames=this.decodedFrames=NaN;this.bufferingTime=this.playTime=this.estimatedBandwidth=0;this.playbackLatency=NaN;this.bufferingHistory=[];this.bandwidthHistory=[];this.streamHistory=[]}function je(a,b){var c=new ke(b);a.streamHistory.push(new le(c));if(c.videoHeight||!a.streamStats)a.streamStats=c}function ke(a){this.videoWidth=a.width;this.videoHeight=a.height;this.videoMimeType=a.a;this.videoBandwidth=a.bandwidth}
function le(a){this.timestamp=jb()/1E3;this.value=a};function me(a,b,c){y.call(this,a);this.l=b;this.b=c;this.a=this.f=null;this.i=new Ka;this.h={};this.g=[];this.w=0;this.c=new B;this.u=null;this.v=0}p(me,y);me.prototype.destroy=function(){this.j=null;for(var a=0;a<this.g.length;++a)this.g[a].close().catch(function(){});this.g=[];this.h=this.a=this.f=null;this.i.destroy();this.l=this.b=this.i=null};
function ne(a){for(var b=new v,c=a.b.Ia(),d=0;d<c.length;++d){var e=c[d];e.a.b||e.b&&!oe(e.b)||b.push(e.contentType,e)}for(var d={},e=!1,f=0;f<c.length;++f){var g=c[f];if(g.a.b&&!b.a.hasOwnProperty(g.contentType)){var h=g.a.b,l=d[h];l||(l=g.a,l={audioCapabilities:void 0,videoCapabilities:void 0,initDataTypes:void 0,distinctiveIdentifier:l.j?"required":"optional",persistentState:l.l||a.b.ja()?"required":"optional"},d[h]=l);if(g.b&&(h=g.contentType+"Capabilities",h in l)){e=!0;l[h]||(l[h]=[]);var m;
"audio"==g.contentType?m=g.a.h:"video"==g.contentType&&(m=g.a.v);l[h].push({contentType:g.b,robustness:m})}}}if(!e)if(c.length)a.a=c[0].a;else throw a=Error("No DRM scheme info provided!"),a.type="drm",a;if(0==Object.keys(d).length)return a.b.za(b),a.c.resolve(),Promise.resolve();m=new B;d=pe(a,d,m);d=d.then(a.bb.bind(a,c,b));d=d.then(a.yb.bind(a));m.reject(null);return d}
function qe(a,b){null==a.u&&(a.u=window.setTimeout(function(){var a=Error("Timeout waiting for sessions.");a.type="storage";this.c.reject(a)}.bind(a),b));return a.c}function pe(a,b,c){for(var d in b){var e=b[d];c=c.catch(function(){return navigator.requestMediaKeySystemAccess(d,[e])})}a.b.ja()&&(c=c.catch(function(){throw Error("Either none of the requested key systems are supported or none of the requested key systems support persistent state.");}));return c}k=me.prototype;
k.bb=function(a,b,c){for(var d=c.keySystem,e=c.getConfiguration(),f=["audio","video"],g=0;g<f.length;++g){var h=f[g];if(!b.a.hasOwnProperty(h)){var l=e[h+"Capabilities"];if(l&&l.length){for(var l=l[0],m=[],t={},q=0;q<a.length;++q){var D=a[q];D.a.b!=d||D.b!=l.contentType||D.id in t||(m.push(D),t[D.id]=!0,this.a?vb(this.a,D.a):this.a=D.a)}b.a[h]=m}}}this.b.za(b);return c.createMediaKeys()};
k.yb=function(a){this.f=a;return this.l.setMediaKeys(this.f).then(C(this,function(){return this.a.g?this.f.setServerCertificate(this.a.g):Promise.resolve()})).then(C(this,function(){if(0<this.b.pa().length)re(this);else{for(var a=0;a<this.a.a.length;++a){var c=this.a.a[a];this.Ma({type:"encrypted",initDataType:c.initDataType,initData:c.initData})}0==this.a.a.length&&H(this.i,this.l,"encrypted",this.Ma.bind(this))}}))};
k.Ma=function(a){var b=new Uint8Array(a.initData),c=Array.prototype.join.apply(b);if(!this.h[c]){try{var d=se(this)}catch(e){d=G(e);this.dispatchEvent(d);this.c.reject(e);return}a=d.generateRequest(a.initDataType,a.initData);this.h[c]=!0;a.catch(C(this,function(a){if(this.h){this.h[c]=!1;var b=G(a);this.dispatchEvent(b);this.c.reject(a)}}));this.g.push(d)}};
function re(a){for(var b=a.b.pa(),c=0;c<b.length;++c){var d=se(a),e=d.load(b[c]);a.g.push(d);e.catch(C(a,function(a){a=G(a);this.dispatchEvent(a)}))}}function se(a){var b=null;if(a.b.ja())try{b=a.f.createSession("persistent-license")}catch(c){throw Error("Persistent licenses are not supported by this key system or platform.");}else b=a.f.createSession();H(a.i,b,"message",a.mb.bind(a));H(a.i,b,"keystatuseschange",a.fb.bind(a));return b}k.mb=function(a){te(this,a.target,this.a,a.message)};
k.fb=function(a){a=a.target.keyStatuses.values();for(var b=a.next();!b.done;b=a.next()){var c=ue[b.value];c&&(c=Error(c),c.type=b.value,b=G(c),this.dispatchEvent(b))}};
function te(a,b,c,d){d=ve(c,d);Oc(new Nc(d.url,d.body,d.method,c.u,d.headers,a.v)).then(C(a,function(a){c.c&&(a=c.c(a));return b.update(a)})).then(C(a,function(){var a=E({type:"sessionReady",detail:b});this.dispatchEvent(a);this.w++;this.w>=this.g.length&&this.c.resolve()})).catch(C(a,function(a){a.Hb=b;a=G(a);this.dispatchEvent(a)}))}
function ve(a,b){var c={url:a.i,body:b.slice(0),method:"POST",headers:{}};if(!a.f)return c;a.f(c);c.url=cb(c,"url","string");if(null==c.url)throw Error("'url' cannot be null.");if(!(c.body instanceof ArrayBuffer||"string"==typeof c.body||null==c.body))throw new TypeError("'body' must be an ArrayBuffer, a string, or null.");c.method=cb(c,"method","string");if("GET"!=c.method&&"POST"!=c.method)throw Error("'method' must be either 'GET' or 'POST'.");c.headers=db(c,"headers",Object);if(null==c.headers)throw Error("'headers' cannot be null.");
return c}var ue={"output-not-allowed":"The required output protection is not available.",expired:"A required key has expired and the content cannot be decrypted.","internal-error":"An unknown error has occurred in the CDM."};function X(a){y.call(this,null);this.a=a;this.b=null;this.f=new Ka;this.w=this.u=this.i=null;this.l=!1;this.g=new ie;this.c={enableAdaptation:!0,streamBufferSize:15,licenseRequestTimeout:0,mpdRequestTimeout:0,segmentRequestTimeout:0,preferredLanguage:"en",restrictions:new tb};this.v=1;this.F=null}p(X,y);n("shaka.player.Player",X);X.version="v1.4.0-81-g47948f4";
X.isBrowserSupported=function(){return!!window.MediaSource&&!!window.MediaKeys&&!!window.navigator&&!!window.navigator.requestMediaKeySystemAccess&&!!window.MediaKeySystemAccess&&!!window.MediaKeySystemAccess.prototype.getConfiguration&&!!window.Promise&&!!Element.prototype.requestFullscreen&&!!document.exitFullscreen&&"fullscreenElement"in document&&!!window.Uint8Array};function oe(a){return"text/vtt"==a?!!window.VTTCue:MediaSource.isTypeSupported(a)}X.isTypeSupported=oe;
X.setTextStyle=function(a){var b=document.getElementById("ShakaPlayerTextStyle");b||(b=document.createElement("style"),b.id="ShakaPlayerTextStyle",document.head.appendChild(b));for(b=b.sheet;b.cssRules.length;)b.deleteRule(0);b.insertRule("::cue { "+Cb(a)+" }",0)};X.prototype.destroy=function(){return this.G().then(C(this,function(){this.f.destroy();this.a=this.f=null})).catch(function(){})};X.prototype.destroy=X.prototype.destroy;
X.prototype.G=function(){if(!this.b)return Promise.resolve();this.l&&we(this);this.a.pause();La(this.f);xe(this);ye(this);this.i.destroy();this.i=null;this.a.src="";var a=this.a.setMediaKeys(null);this.b&&(this.b.destroy(),this.b=null);this.l=!1;this.g=new ie;return a};X.prototype.unload=X.prototype.G;
X.prototype.Xa=function(a){var b=this.G();this.a.autoplay&&(da("load"),H(this.f,this.a,"timeupdate",this.eb.bind(this)));a.F(this.c);a.Ta(this.F);this.F=null;return b.then(C(this,function(){return a.U()})).then(C(this,function(){this.b=a;this.i=new me(this,this.a,this.b);return ne(this.i)})).then(C(this,function(){H(this.f,this.a,"error",this.zb.bind(this));H(this.f,this.a,"playing",this.jb.bind(this));H(this.f,this.a,"pause",this.ib.bind(this));return this.b.Ea(this,this.a)})).then(C(this,function(){ze(this)})).catch(C(this,
function(b){a.destroy();this.b=null;this.i&&(this.i.destroy(),this.i=null);var d=G(b);this.dispatchEvent(d);return Promise.reject(b)}))};X.prototype.load=X.prototype.Xa;k=X.prototype;k.eb=function(){ga("load");this.g.playbackLatency=ha("load")/1E3;this.f.ma(this.a,"timeupdate")};k.zb=function(){if(this.a.error){var a=this.a.error.code;a!=MediaError.MEDIA_ERR_ABORTED&&(a=Error(Ae[a]||"Unknown playback error."),a.type="playback",a=G(a),this.dispatchEvent(a))}};
k.jb=function(){da("playing");!this.u&&0>this.v&&(this.a.playbackRate=0,this.D(this.a.currentTime,Date.now(),this.v));this.l&&we(this)};k.ib=function(){ga("playing");var a=ha("playing");if(!isNaN(a)){var b=this.g;b.playTime+=a/1E3}ye(this)};
k.Ua=function(){if(!this.a.paused){ga("playing");var a=ha("playing");if(!isNaN(a)){var b=this.g;b.playTime+=a/1E3;da("playing")}}a=this.g;b=this.a;b.getVideoPlaybackQuality&&(b=b.getVideoPlaybackQuality(),a.decodedFrames=b.totalVideoFrames,a.droppedFrames=b.droppedVideoFrames);return this.g};X.prototype.getStats=X.prototype.Ua;X.prototype.fa=function(){return this.b?this.b.sa():[]};X.prototype.getVideoTracks=X.prototype.fa;X.prototype.S=function(){return this.b?this.b.ra():[]};
X.prototype.getAudioTracks=X.prototype.S;X.prototype.oa=function(){return this.b?this.b.Ba():[]};X.prototype.getTextTracks=X.prototype.oa;X.prototype.selectVideoTrack=function(a,b){return this.b?this.b.selectVideoTrack(a,void 0==b?!0:b):!1};X.prototype.selectVideoTrack=X.prototype.selectVideoTrack;X.prototype.Ya=function(a,b){return this.b?this.b.Ra(a,void 0==b?!0:b):!1};X.prototype.selectAudioTrack=X.prototype.Ya;X.prototype.Za=function(a){return this.b?this.b.Sa(a,!1):!1};
X.prototype.selectTextTrack=X.prototype.Za;X.prototype.na=function(a){this.b&&this.b.Aa(a)};X.prototype.enableTextTrack=X.prototype.na;X.prototype.H=function(a){this.h({enableAdaptation:a})};X.prototype.enableAdaptation=X.prototype.H;X.prototype.I=function(){return this.c.enableAdaptation};X.prototype.getAdaptationEnabled=X.prototype.I;X.prototype.ea=function(a){this.h({streamBufferSize:a})};X.prototype.setStreamBufferSize=X.prototype.ea;X.prototype.P=function(){return Number(this.c.streamBufferSize)};
X.prototype.getStreamBufferSize=X.prototype.P;X.prototype.$a=function(a){this.h({licenseRequestTimeout:a/1E3})};X.prototype.setLicenseRequestTimeout=X.prototype.$a;X.prototype.W=function(a){this.h({mpdRequestTimeout:a/1E3})};X.prototype.setMpdRequestTimeout=X.prototype.W;X.prototype.Y=function(a){this.h({segmentRequestTimeout:a/1E3})};X.prototype.setRangeRequestTimeout=X.prototype.Y;X.prototype.K=function(a){this.h({preferredLanguage:a})};X.prototype.setPreferredLanguage=X.prototype.K;
X.prototype.X=function(a){ye(this);0<=a?this.a.playbackRate=a:this.a.paused||(this.a.playbackRate=0,this.D(this.a.currentTime,Date.now(),a));this.v=a};X.prototype.setPlaybackRate=X.prototype.X;X.prototype.J=function(){return this.v};X.prototype.getPlaybackRate=X.prototype.J;X.prototype.Z=function(a){this.h({restrictions:a})};X.prototype.setRestrictions=X.prototype.Z;X.prototype.O=function(){return this.c.restrictions.clone()};X.prototype.getRestrictions=X.prototype.O;
X.prototype.ab=function(a){this.F=a};X.prototype.setPlaybackStartTime=X.prototype.ab;X.prototype.ga=function(){return this.b?this.b.Qa():!1};X.prototype.isLive=X.prototype.ga;
X.prototype.h=function(a){if(a){var b;b=cb(a,"enableAdaptation","boolean");null!=b&&(this.c.enableAdaptation=b);b=bb(a,"streamBufferSize");null!=b&&(this.c.streamBufferSize=b);b=bb(a,"licenseRequestTimeout");null!=b&&(this.c.licenseRequestTimeout=b);b=bb(a,"mpdRequestTimeout");null!=b&&(this.c.mpdRequestTimeout=b);b=bb(a,"segmentRequestTimeout");null!=b&&(this.c.segmentRequestTimeout=b);b=cb(a,"preferredLanguage","string");null!=b&&(this.c.preferredLanguage=b);a=db(a,"restrictions",tb);null!=a&&(this.c.restrictions=
a.clone());this.b&&this.b.F(this.c)}};X.prototype.configure=X.prototype.h;X.prototype.$=function(){return this.c};X.prototype.getConfiguration=X.prototype.$;function ye(a){a.u&&(window.clearTimeout(a.u),a.u=null)}function ze(a){xe(a);a.w=window.setTimeout(a.R.bind(a),100)}function xe(a){a.w&&(window.clearTimeout(a.w),a.w=null)}
X.prototype.D=function(a,b,c){var d=.1*Math.abs(c);this.a.buffered.length&&this.a.buffered.start(0)+d<this.a.currentTime?(this.a.currentTime=a+(Date.now()-b)/1E3*c,this.u=window.setTimeout(this.D.bind(this,a,b,c),100)):this.a.pause()};function we(a){ga("buffering");var b=a.g;b.bufferingTime+=ha("buffering")/1E3;a.l=!1;a.dispatchEvent(E({type:"bufferingEnd"}))}
X.prototype.R=function(){ze(this);if(!this.a.ended&&!this.a.seeking){var a=this.a.buffered,b=a.length?a.end(a.length-1):0,a=Math.max(b-this.a.currentTime,0);if(this.l)a>this.b.Ja()&&(we(this),this.a.play());else{var c=this.a.duration,c=isNaN(c)?0:Math.max(c-.05,0),b=b>=c||this.a.currentTime>=c;!this.a.paused&&!b&&.1>a&&(this.l=!0,this.a.pause(),this.g.bufferingHistory.push(jb()/1E3),da("buffering"),this.dispatchEvent(E({type:"bufferingStart"})))}}};
var Ae={2:"A network failure occured while loading media content.",3:"The browser failed to decode the media content.",4:"The browser does not support the media content."};function Be(a,b,c){y.call(this,null);this.f=a;this.c=b;this.b=c?c:ub();this.a=null}p(Be,y);n("shaka.player.HttpVideoSource",Be);Be.prototype.F=function(){};Be.prototype.destroy=function(){this.a&&(this.a.parentElement.removeChild(this.a),this.a=null);this.j=this.b=null};k=Be.prototype;k.Ea=function(a,b){this.j=a;var c=b.mediaKeys;b.src=this.f;c=b.setMediaKeys(c);this.c&&(this.a=document.createElement("track"),this.a.src=this.c,b.appendChild(this.a),this.a.track.mode="showing");return c};k.U=function(){return Promise.resolve()};
k.sa=function(){return[]};k.ra=function(){return[]};k.Ba=function(){return[]};k.Ja=function(){return 5};k.Ia=function(){var a=new Zd;a.a=this.b;return[a]};k.za=function(){};Be.prototype.selectVideoTrack=function(){return!1};k=Be.prototype;k.Ra=function(){return!1};k.Sa=function(){return!1};k.Aa=function(a){this.a&&(this.a.track.mode=a?"showing":"disabled")};k.Ta=function(){};k.pa=function(){return[]};k.ja=function(){return!1};k.Qa=function(){return!1};function Ce(a){this.b=a;this.a=null}Ce.prototype.destroy=function(){this.a&&(this.a.destroy(),this.a=null)};Ce.prototype.create=function(){if(this.a)return Promise.resolve(this.a);var a=new S(0,null,this.b);this.a=new T([a]);return Promise.resolve(this.a)};function De(a){this.a=a}
function Ee(a,b){for(var c=jb()/1E3,d=0;d<b.a.length;++d)for(var e=b.a[d],f=0;f<e.b.length;++f){var g=e.b[f];if("text"!=g.contentType)for(var h=0;h<g.a.length;++h){var l=g.a[h],m=0,m=m+(l.f?1:0),m=m+(l.b?1:0),m=m+(l.a?1:0);0==m?(g.a.splice(h,1),--h):1!=m&&(l.f?(l.b=null,l.a=null):l.b&&(l.a=null))}}Fe(b);for(d=0;d<b.a.length;++d)for(e=b.a[d],f=0;f<e.b.length;++f){h=g=e.b[f];l=null;for(m=0;m<h.a.length;++m){var t=h.a[m].c||"";l?t!=l&&(h.a.splice(m,1),--m):l=t}0==g.a.length&&(e.b.splice(f,1),--f)}"dynamic"==
b.type&&null==b.b&&(b.b=c);d=new ae;"dynamic"==b.type&&(d.b=!0,d.f=b.g,d.g=new K(b.i||b.url));d.c=b.h||5;for(e=0;e<b.a.length;++e){f=b.a[e];if(null==f.start)break;g=new $d;g.id=f.id;g.start=f.start||0;g.b=f.a;for(h=0;h<f.b.length;++h){l=f.b[h];m=new Wd;m.id=l.id;m.c=l.c;m.lang=l.lang||"";m.contentType=l.contentType||"";m.b=l.f;for(t=0;t<l.a.length;++t){var q=l.a[t],D=m.a.slice(0),w=a,r=q,A=D,F=[];if(0==r.g.length)F.push(ub());else if(w.a)for(var u=0;u<r.g.length;++u){var x=w.a(r.g[u]);x&&F.push(x)}if(0==
A.length)Array.prototype.push.apply(A,F);else for(w=0;w<A.length;++w){r=!1;for(u=0;u<F.length;++u)if(A[w].key()==F[u].key()){r=!0;break}r||(A.splice(w,1),--w)}if(!(0==D.length&&0<m.a.length)){w=b;F=f;A=c;if(q.m&&0!==q.m.length){r=null;u=1;x=0;if(q.f)r=q.c.split("/")[1],"mp4"!=r&&"webm"!=r?r=null:(u=q.f,"webm"!=r||u.c?u.a||u.b&&u.b.a?(x=u.b,x||(x=new ad,x.url=q.m,x.a=u.a?u.a.clone():null),x=Ge(x),u=u.c?Ge(u.c):null,A=new Sd(w,F,r,x,u,A),F=new yd(u),w=new Td,w.C=A,w.A=F,r=w):r=null:r=null),u=q.f.g,
x=q.f.f;else if(q.b)r=q.b,!r.b&&!r.c&&1<r.a.length?r=null:r.b||F.a||r.c||1!=r.a.length?r.c&&0===r.c.a.length?r=null:(r=r.g?Ge(r.g):null,A=new Od(w,F,q,A),F=new yd(r),w=new Td,w.C=A,w.A=F,r=w):r=null,u=q.b.f,x=q.b.j;else if(q.a){b:if(r=q.a,u=r,x=0,x+=u.f?1:0,x+=u.c?1:0,x+=u.a?1:0,0==x?u=!1:(1!=x&&(u.f?(u.c=null,u.a=null):u.c&&(u.a=null)),u=!0),u){u=null;if(r.g&&(u=(r=q.a.g)?He(q,r,bd):null,!u)){r=null;break b}r=u?Ge(u):null;var u=q,x=r,I=u.a;if(I.f){I=void 0;I=u.c.split("/")[1];if("mp4"!=I&&"webm"!=
I)I=null;else if("webm"!=I||x)if(vd(u,1,0)){var wa=void 0;(wa=(wa=u.a.f)?He(u,wa,ad):null)?(u=Ge(wa),I=new Sd(w,F,I,u,x,A)):I=null}else I=null;else I=null;A=I}else A=I.h?I.c?new Nd(w,F,u,A):I.a?"dynamic"!=w.type&&null==F.a?null:new Pd(w,F,u,A):void 0:null;A?(F=new yd(r),w=new Td,w.C=A,w.A=F,r=w):r=null}else r=null;u=q.a.b;x=q.a.i}else"text"==q.c.split("/")[0]&&(r=new Td,r.C=new Ce(new K(q.m)));r?(r.id=q.id,x&&(r.c=-1*x/u),r.bandwidth=q.bandwidth,r.width=q.width,r.height=q.height,r.a=q.c||"",r.b=q.h||
"",q=r):q=null}else q=null;q&&(m.o.push(q),m.a=D)}}g.a.push(m)}d.a.push(g)}return d}
function Fe(a){if(a.a.length){null==a.a[0].start&&(a.a[0].start=0);var b=function(a){return 0==a||!!a};"dynamic"==a.type&&(a.c=null);b(a.c)&&1==a.a.length&&!b(a.a[0].a)&&(a.a[0].a=a.c);for(var c=0,d=!0,e=0;e<a.a.length;++e){var f=a.a[e-1],g=a.a[e],h=a.a[e+1]||{start:a.c};!b(g.start)&&f&&b(f.start)&&b(f.a)&&(g.start=f.start+f.a);!b(g.a)&&b(h.start)&&(g.a=h.start-g.start);null!=g.start&&null!=g.a?c+=g.a:d=!1}b(a.c)||(e=a.a[a.a.length-1],d?a.c=c:b(e.start)&&b(e.a)?a.c=e.start+e.a:"dynamic"!=a.type&&
(a.c=c))}}function He(a,b,c){b=wd(b,a.id,null,a.bandwidth,null);if(!b)return null;c=new c;c.url=Lc(a.m,b);return c}function Ge(a){var b=a.url,c=0,d=null;a.a&&(c=a.a.ha,d=a.a.end);return new K(b,c,d)};function Ie(a){for(var b=0;b<a.length;++b)for(var c=a[b],d=0;d<c.a.length;++d){for(var e=c.a[d],f=e,g=0;g<f.o.length;++g)oe(Vd(f.o[g]))||(f.o.splice(g,1),--g);0==e.o.length&&(c.a.splice(d,1),--d)}}function Je(a){for(var b=0;b<a.length;++b)for(var c=a[b],d=0;d<c.a.length;++d)c.a[d].o.sort(Ke)}function Ke(a,b){var c=a.bandwidth||Number.MAX_VALUE,d=b.bandwidth||Number.MAX_VALUE;return c<d?-1:c>d?1:0};function Le(a){this.a=a}Le.prototype.destroy=function(){this.a.destroy();this.a=null};function Me(a,b){var c=Ne(b),d=Ne(a.a);return Promise.all([c,d]).then(C(a,function(a){var c=a[0];a=a[1];var d=this.a.a;Ie(d);Je(d);b.f=this.a.f;b.g=this.a.g?this.a.g.clone():null;b.c=this.a.c;d=[];Oe(b,this.a,c,a,d);c=b.a;Ie(c);Je(c);return Promise.resolve(d)}))}
function Ne(a){function b(a,b){return a.concat(b)}var c=a.a.map(function(a){return a.a}).reduce(b,[]).map(function(a){return a.o}).reduce(b,[]);a=c.map(function(a){return a.C.create()});return Promise.all(a).then(function(a){for(var b={},f=0;f<c.length;++f)b[c[f].B]=a[f];return Promise.resolve(b)})}
function Oe(a,b,c,d,e){var f=new v;a.a.forEach(function(a,b){f.push(a.id||""+b,a)});var g=new v;b.a.forEach(function(a,b){g.push(a.id||""+b,a)});a=ua(f);for(b=0;b<a.length;++b){var h=a[b],l=f.get(h);1<l.length||(h=g.get(h))&&0!=h.length&&1==h.length&&(Pe(l[0],h[0],c,d,e),l[0].b=h[0].b)}}
function Pe(a,b,c,d,e){var f=new v;a.a.forEach(function(a,b){f.push(a.id||""+b,a)});var g=new v;b.a.forEach(function(a,b){g.push(a.id||""+b,a)});a=ua(f);for(b=0;b<a.length;++b){var h=a[b],l=f.get(h);1<l.length||(h=g.get(h))&&0!=h.length&&1==h.length&&Re(l[0],h[0],c,d,e)}}
function Re(a,b,c,d,e){var f=new v;a.o.forEach(function(a,b){f.push(a.id||""+b,a)});var g=new v;b.o.forEach(function(a,b){g.push(a.id||""+b,a)});b={};for(var h=ua(f),l=0;l<h.length;++l){var m=h[l];b[m]=m;var t=f.get(m);1<t.length||((m=g.get(m))&&0!=m.length?1==m.length&&(Se(t[0],m[0],c,d),t[0].A=m[0].A,m[0].A=null,t[0].c=m[0].c):(e.push(t[0]),a.o.splice(a.o.indexOf(t[0]),1)))}h=ua(g);for(l=0;l<h.length;++l)m=h[l],b[m]||(b[m]=m,m=g.get(m),a.o.push(m[0]))}
function Se(a,b,c,d){a=c[a.B];b=d[b.B];a.length();a.xa(b)&&a.length()};function Te(){this.a=this.c=null;this.f=new Ka;this.b=Number.POSITIVE_INFINITY;this.g=!0}n("shaka.media.SimpleAbrManager",Te);Te.prototype.destroy=function(){this.f.destroy();this.a=this.c=this.f=null};Te.prototype.start=function(a,b){this.c&&this.a||(this.c=a,this.a=b,this.b=Date.now()+4E3,H(this.f,this.c,"bandwidth",this.j.bind(this)),H(this.f,this.a,"adaptation",this.h.bind(this)))};Te.prototype.enable=function(a){this.g=a};
Te.prototype.getInitialVideoTrackId=function(){if(!this.a||!this.c)return null;var a=Ue(this);return a?a.id:null};Te.prototype.selectVideoTrack=function(a,b,c){this.a.selectVideoTrack(a.id,b,c)};Te.prototype.j=function(){if(this.g&&!(Date.now()<this.b)){var a=Ue(this);if(a){if(a.active){this.b=Date.now()+3E3;return}this.selectVideoTrack(a,!1)}this.b=Number.POSITIVE_INFINITY}};Te.prototype.h=function(){this.b==Number.POSITIVE_INFINITY&&(this.b=Date.now()+3E4)};
function Ue(a){var b=a.a.sa();if(0==b.length)return null;b.sort(Gb);var c;a:{c=a.a.ra();for(var d=0;d<c.length;++d)if(c[d].active){c=c[d];break a}c=null}c=c?c.bandwidth:0;a=a.c.getBandwidth();for(var d=b[0],e=0;e<b.length;++e){var f=b[e],g=e+1<b.length?b[e+1]:{bandwidth:Number.POSITIVE_INFINITY};if(f.bandwidth&&(g=(g.bandwidth+c)/.85,a>=(f.bandwidth+c)/.95&&a<=g&&(d=f,d.active)))break}return d};function Ve(a,b,c,d,e){y.call(this,a);this.c=b;this.a=new Hb(c,d,e);this.D=this.H=this.b=null;this.J=0;this.I=!1;this.g=null;this.l=!1;this.h=null;this.v=!1;this.u=new B;this.i=this.f=!1;this.w=15;this.F=!1}p(Ve,y);Ve.prototype.G=function(a){null!=a.streamBufferSize&&(this.w=Number(a.streamBufferSize));null!=a.segmentRequestTimeout&&(this.a.l=Number(a.segmentRequestTimeout))};Ve.prototype.destroy=function(){We(this);this.b=this.u=null;this.a.destroy();this.j=this.c=this.a=null};k=Ve.prototype;
k.ia=function(){return this.b};k.Ka=function(){return this.H};k.Wa=function(a){this.f||a.then(function(){this.f=!0;this.g||Xe(this,0)}.bind(this));return this.u};k.La=function(){return this.i};
k.la=function(a,b,c,d){if(a!=this.b){var e=[a.C.create(),a.A.create()];Promise.all(e).then(C(this,function(e){if(this.c){var g=this.b;this.b=a;this.H=e[0];this.D=e[1];this.J=b;this.I=!0;this.l||(g?c&&Ye(this,!0,d):Xe(this,0))}})).catch(C(this,function(a){"aborted"!=a.type&&(this.f?(a=G(a),this.dispatchEvent(a)):this.u.reject(a))}))}};k.Pa=function(){return Ye(this,!1)};
function Ye(a,b,c){a.b&&!a.l&&(a.l=!0,We(a),Jb(a.a).then(C(a,function(){var a=this.c.currentTime;if(!b&&0<Kb(this.a,a)&&0<=Pb(this.a.b,a))return Promise.resolve();if(c)return Sb(this.a,this.c.currentTime+c);this.F=!0;return Rb(this.a)})).then(C(a,function(){this.l=!1;Xe(this,0)})).catch(C(a,function(a){this.l=!1;this.f?(a=G(a),this.dispatchEvent(a)):this.u.reject(a)})))}k.qa=function(){};k.va=function(){return!0};
k.rb=function(){if(this.v&&!this.f)this.g=null;else{var a;if(a=this.f&&!this.i)a=1<this.a.c.buffered.length?!0:!1;if(a)Ye(this,!0);else{this.g=null;a=this.b;var b=this.H,c=this.c.currentTime,d=Kb(this.a,c),e=this.v?this.w:Math.min(this.J,this.w)+(this.h||0);d>=e?(Ze(this),Xe(this,1E3/(Math.abs(this.c.playbackRate)||1))):(b=$e(this,c,b))?(b=Lb(this.a,b,this.D),this.D=null,this.I&&(this.I=!1,af(this,a)),this.i=!1,b.then(C(this,function(a){null==this.h&&(this.h=a);this.F&&0<Kb(this.a,c)&&(this.F=!1,
this.c.currentTime+=.001);Xe(this,0)})).catch(C(this,function(a){if("aborted"!=a.type){var b=[0,404,410];"net"==a.type&&-1!=b.indexOf(a.Fb.status)&&this.b&&Xe(this,5E3);a=G(a);this.dispatchEvent(a)}}))):(Ze(this),this.f&&!this.i&&(this.i=!0,bf(this)),Xe(this,1E3))}}};function $e(a,b,c){a=a.a;var d=a.b.length;a=0<d?a.b[d-1]:null;return null!=a?null!=a.a?c.da(a.a):null:c.da(b)||(c.length()?V(c):null)}
function Ze(a){if(!a.v&&null!=a.h){a.v=!0;var b=a.a,c=a.h,d=c-b.u;0!=d&&(b.b=zd(b.b,d),b.u=c);a.u.resolve(a.h)}}function af(a,b){var c;c=b.a.split("/")[0];c=E({type:"adaptation",bubbles:!0,contentType:c,size:"video"!=c?null:{width:b.width,height:b.height},bandwidth:b.bandwidth});a.dispatchEvent(c)}function bf(a){var b=E({type:"ended"});a.dispatchEvent(b)}function Xe(a,b){a.g=window.setTimeout(a.rb.bind(a),b)}function We(a){null!=a.g&&(window.clearTimeout(a.g),a.g=null)};function cf(a,b){y.call(this,a);this.b=b;this.g=!0;this.f=this.c=null;this.h=new B;this.a=null}p(cf,y);cf.prototype.G=function(){};cf.prototype.destroy=function(){this.a&&this.b.removeChild(this.a);this.j=this.b=this.c=this.f=this.a=null};k=cf.prototype;k.ia=function(){return this.c};k.Ka=function(){return this.f};k.Wa=function(){return this.h};k.La=function(){return!0};
k.la=function(a){a.C.create().then(C(this,function(b){if(this.b){if(0==b.length())return Promise.reject(Error("No subtitles URL available."));var c=this.c;this.c=a;this.f=b;b=U(b).url.c[0].toString();var d=this.va();this.a&&(this.qa(!1),this.b.removeChild(this.a));this.a=document.createElement("track");this.b.appendChild(this.a);this.a.src=b;this.qa(d);b=E({type:"adaptation",bubbles:!0,contentType:"text",size:null,bandwidth:a.bandwidth});this.dispatchEvent(b);c||this.h.resolve(0)}}))};k.Pa=function(){};
k.qa=function(a){this.g=a;this.a&&(this.a.track.mode=a?"showing":"disabled")};k.va=function(){return this.g};function Y(a,b,c){y.call(this,null);this.a=a;this.G=b;this.l=new Ka;this.g=new MediaSource;this.f=null;this.X=0;this.c=new v;this.I=c;this.D=!1;this.w="en";this.Z=!1;this.H=null;this.W=new B;this.h=new tb;this.u=null;this.oa=1;this.b={};this.ea=new B;this.J=0;this.na=!1;this.i={};this.P=this.O=this.R=null;this.Y={}}p(Y,y);n("shaka.player.StreamVideoSource",Y);
Y.prototype.F=function(a){null!=a.streamBufferSize&&(this.Y.streamBufferSize=a.streamBufferSize);null!=a.segmentRequestTimeout&&(this.Y.segmentRequestTimeout=a.segmentRequestTimeout);for(var b in this.b)this.b[b].G(this.Y);null!=a.enableAdaptation&&this.I.enable(Boolean(a.enableAdaptation));null!=a.mpdRequestTimeout&&(this.X=Number(a.mpdRequestTimeout));null!=a.preferredLanguage&&(this.w=fb(String(a.preferredLanguage)));null!=a.restrictions&&(this.h=a.restrictions,this.D&&df(this))};
Y.prototype.destroy=function(){this.O&&(window.clearTimeout(this.O),this.O=null);this.R&&(window.clearTimeout(this.R),this.R=null);this.i=null;this.l.destroy();this.ea=this.l=null;ab(this.b).forEach(function(a){a.destroy()});this.c=this.b=null;this.a&&(this.a.destroy(),this.a=null);this.I.destroy();this.j=this.h=this.W=this.H=this.f=this.g=this.G=this.I=null};k=Y.prototype;
k.Ea=function(a,b){if(!this.D){var c=Error("Cannot call attach() right now.");c.type="stream";return Promise.reject(c)}this.j=a;this.f=b;this.H=a.Ua();H(this.l,this.g,"sourceopen",this.hb.bind(this));H(this.l,this.G,"bandwidth",this.Ab.bind(this));c=this.f.mediaKeys;this.f.src=window.URL.createObjectURL(this.g);c=this.f.setMediaKeys(c);return Promise.all([this.W,c])};
k.U=function(){if(this.D){var a=Error("Cannot call load() right now.");a.type="stream";return Promise.reject(a)}if(!this.a||0==this.a.a.length)return a=Error("The manifest does not specify any content."),a.type="stream",Promise.reject(a);a=this.a.a;Ie(a);Je(a);if(0==this.a.a.length||0==this.a.a[0].a.length)return a=Error("The manifest specifies content that cannot be displayed on this browser/platform."),a.type="stream",Promise.reject(a);this.D=!0;df(this);return Promise.resolve()};
k.pb=function(){var a=Date.now(),b=this.R=null;this.Na(this.a.g).then(C(this,function(a){b=new Le(a);return Me(b,this.a)})).then(C(this,function(c){b.destroy();b=null;for(var d=0;d<c.length;++d)ef(this,c[d]);df(this);0==Object.keys(this.b).length?ff(this):gf(this,(Date.now()-a)/1E3)})).catch(C(this,function(a){b&&(b.destroy(),b=null);"aborted"!=a.type&&(a=G(a),this.dispatchEvent(a),this.a&&gf(this,0))}))};k.Na=function(){return Promise.reject("Cannot update manifest with this VideoSource implementation.")};
function ef(a,b){var c=b.a.split("/")[0],d=a.b[c];if(d&&d.ia()==b){var e=a.c.get(b.a.split("/")[0]),f=e.map(function(a){return a.o}).reduce(function(a,b){return a.concat(b)},[]).filter(function(a){return a.enabled});if(0==f.length){e.push(b);return}a.i[c].Ca==b&&delete a.i[c];d.la(f[0],a.a.c,!0);b.destroy()}b.destroy()}
k.sa=function(){if(!this.c.a.hasOwnProperty("video"))return[];for(var a=this.b.video,a=(a=a?a.ia():null)?a.B:0,b=[],c=this.c.get("video"),d=0;d<c.length;++d)for(var e=c[d],f=0;f<e.o.length;++f){var g=e.o[f];if(g.enabled){var h=g.B,g=new Fb(h,g.bandwidth,g.width,g.height);h==a&&(g.active=!0);b.push(g)}}return b};Y.prototype.getVideoTracks=Y.prototype.sa;
Y.prototype.ra=function(){if(!this.c.a.hasOwnProperty("audio"))return[];for(var a=this.b.audio,a=(a=a?a.ia():null)?a.B:0,b=[],c=this.c.get("audio"),d=0;d<c.length;++d)for(var e=c[d],f=e.lang,g=0;g<e.o.length;++g){var h=e.o[g],l=h.B,h=new wb(l,h.bandwidth,f);l==a&&(h.active=!0);b.push(h)}return b};Y.prototype.getAudioTracks=Y.prototype.ra;
Y.prototype.Ba=function(){if(!this.c.a.hasOwnProperty("text"))return[];for(var a=this.b.text,b=a?a.ia():null,b=b?b.B:0,c=[],d=this.c.get("text"),e=0;e<d.length;++e)for(var f=d[e],g=f.lang,h=0;h<f.o.length;++h){var l=f.o[h].B,m=new Eb(l,g);l==b&&(m.active=!0,m.enabled=a.va());c.push(m)}return c};Y.prototype.getTextTracks=Y.prototype.Ba;Y.prototype.Ja=function(){return this.a&&this.a.c||0};
Y.prototype.Ia=function(){var a;if(this.D){a=this.a.a[0];for(var b=[],c=0;c<a.a.length;++c)b.push.apply(b,Yd(a.a[c]));a=b}else a=[];return a};
Y.prototype.za=function(a){if(this.D){for(var b={},c=this.a.a[0],d=0;d<c.a.length;++d){var e=c.a[d];b[e.B]=e}this.c.a={};c=ua(a);for(d=0;d<c.length;++d){var e=c[d],f=a.get(e);if("video"==e){var g=f[0].id;this.c.push(e,b[g])}else if("audio"==e)for(var g=f[0].b.split(";")[0],h=0;h<f.length;++h){var l=f[h];l.b.split(";")[0]==g&&this.c.push(e,b[l.id])}else for(h=0;h<f.length;++h)g=f[h].id,this.c.push(e,b[g])}this.Z=!0;if(a=this.c.get("audio"))hf(this,a),this.c.a.audio=a,a=a[0].lang||this.w,eb(2,this.w,
a)&&(this.Z=!1);if(a=this.c.get("text"))hf(this,a),this.c.a.text=a,a=a[0].lang||this.w,eb(2,this.w,a)||(this.Z=!1)}};Y.prototype.selectVideoTrack=function(a,b,c){return jf(this,"video",a,b,c)};k=Y.prototype;k.Ra=function(a,b){return jf(this,"audio",a,b)};k.Sa=function(a,b){return jf(this,"text",a,b)};k.Aa=function(a){var b=this.b.text;b&&b.qa(a)};k.Ta=function(a){this.P=a};
function df(a){if(a.h)for(var b=0;b<a.a.a.length;++b)for(var c=a.a.a[b],d=0;d<c.a.length;++d)for(var e=c.a[d],f=0;f<e.o.length;++f){var g=e.o[f];g.enabled=!0;a.h.maxWidth&&g.width>a.h.maxWidth&&(g.enabled=!1);a.h.maxHeight&&g.height>a.h.maxHeight&&(g.enabled=!1);a.h.maxBandwidth&&g.bandwidth>a.h.maxBandwidth&&(g.enabled=!1);a.h.minBandwidth&&g.bandwidth<a.h.minBandwidth&&(g.enabled=!1)}}k.pa=function(){return[]};k.ja=function(){return!1};k.Qa=function(){return this.a?this.a.b:!1};
function jf(a,b,c,d,e){if(!a.c.a.hasOwnProperty(b)||!a.b[b])return!1;for(var f=a.c.get(b),g=0;g<f.length;++g)for(var h=f[g],l=0;l<h.o.length;++l){var m=h.o[l];if(m.B==c){if("text"!=b&&!a.na)return c=a.i[b],a.i[b]={Ca:m,Fa:null!=c&&c.Fa||d,Ga:null!=c&&c.Ga||e},!0;je(a.H,m);a.b[b].la(m,a.a.c,d,e);return!0}}return!1}
function hf(a,b){for(var c=0;2>=c;++c)for(var d=0;d<b.length;++d){var e=b[d];if(eb(c,a.w,e.lang)){b.splice(d,1);b.splice(0,0,e);return}}for(d=0;d<b.length;++d)if(e=b[d],e.b){b.splice(d,1);b.splice(0,0,e);break}}k.hb=function(){this.l.ma(this.g,"sourceopen");ff(this).then(C(this,function(){this.W.resolve()})).catch(C(this,function(a){this.W.reject(a)}))};
function ff(a){for(var b=[],c=["audio","video","text"],d=0;d<c.length;++d){var e=c[d];a.c.a.hasOwnProperty(e)&&b.push(a.c.get(e)[0])}a.I.start(a.G,a);var f=kf(a,b),b=ab(f).map(function(a){return a.C.create()});return Promise.all(b).then(C(a,function(a){if(!a.every(function(a){return a.length()}))return a=Error("Some streams are not available."),a.type="stream",Promise.reject(a);a=lf(this,a);if(!a)return a=Error("Some streams are not available."),a.type="stream",Promise.reject(a);if(!mf(this,f))return a=
Error("Failed to create Stream objects."),a.type="stream",Promise.reject(a);nf(this,f,a);return Promise.resolve()})).catch(C(a,function(a){if("aborted"!=a.type)return Object.keys(this.b),this.a.b?(gf(this,0),Promise.resolve()):Promise.reject(a)}))}
function kf(a,b){for(var c={},d=0;d<b.length;++d){var e=b[d],f=e.o[0];if("video"==e.contentType)for(var g=a.I.getInitialVideoTrackId(),h=0;h<e.o.length&&(f=e.o[h],f.B!=g);++h);else"audio"==e.contentType&&(f=e.o[Math.floor(e.o.length/2)]);c[e.contentType]=f}return c}function mf(a,b){var c={},d;for(d in b){var e=b[d],e="text"==d?new cf(a,a.f):of(a,e);if(!e)return ab(c).forEach(function(a){a.destroy()}),!1;c[d]=e}a.b=c;return!0}
function of(a,b){var c;try{c=a.g.addSourceBuffer(Vd(b))}catch(d){return null}try{c.timestampOffset=b.c}catch(e){return null}c=new Ve(a,a.f,a.g,c,a.G);c.G(a.Y);return c}
function nf(a,b,c){a.oa=a.f.playbackRate;a.f.playbackRate=0;pf(a,c);var d;d=a.a.b?c.end:a.P&&a.P<=c.end&&a.P>=c.start?a.P:c.start;H(a.l,a.f,"seeking",a.lb.bind(a));a.f.currentTime!=d&&(a.f.currentTime=d,a.u=d);qf(a,c.start,c.end);c=[];for(var e in a.b){d=a.b[e];c.push(d.Wa(a.ea));H(a.l,d,"ended",a.nb.bind(a));var f=b[e];je(a.H,f);d.la(f,a.a.c,!1)}Promise.all(c).then(a.cb.bind(a)).catch(C(a,function(a){a=G(a);this.dispatchEvent(a)}));a.Aa(a.Z)}
k.cb=function(a){ba(a&&a.length==Object.keys(this.b).length);for(var b=Number.POSITIVE_INFINITY,c=Number.NEGATIVE_INFINITY,d=0;d<a.length;++d)var e=a[d],b=Math.min(b,e),c=Math.max(c,e);a=rf(this);for(d=0;d<a.length;++d)a[d].ca(c);sf(this,a,c);d=sa(this.c).map(function(a){return a.o}).reduce(function(a,b){return a.concat(b)},[]).map(function(a){var b=[a.C.create()];a.A&&b.push(a.A.create());return Promise.all(b)});Promise.all(d).then(C(this,function(a){for(var b=0;b<a.length;++b)a[b][0].ca(c);this.na=
!0;for(var d in this.i)a=this.i[d],b=this.b[d],je(this.H,a.Ca),b.la(a.Ca,this.a.c,a.Fa,a.Ga);this.i={}})).catch(C(this,function(a){"aborted"!=a.type&&(a=G(a),this.dispatchEvent(a))}))};function sf(a,b,c){if(b=lf(a,b))pf(a,b),qf(a,b.start,b.end);0!=c?(c=a.f.currentTime+c,a.f.currentTime=c,a.u=c):c=a.f.currentTime;a.a.b&&b&&(a.J=b.end-c,a.J=Math.max(a.J,0));a.f.playbackRate=a.oa;null!=a.a.f&&gf(a,a.J);tf(a);a.ea.resolve()}
function pf(a,b){if(a.a.b)isNaN(a.g.duration)&&(a.g.duration=b.end+2592E3);else if(isNaN(a.g.duration)||b.end>a.g.duration){a.g.duration=b.end;for(var c=0;c<a.g.sourceBuffers.length;++c)a.g.sourceBuffers[c].appendWindowEnd=b.end}}k.qb=function(){this.O=null;tf(this);var a=lf(this,rf(this));a&&(qf(this,a.start,a.end),this.f.paused||uf(this,this.f.currentTime,a.start,a.end))};function qf(a,b,c){b=E({type:"seekrangechanged",bubbles:!0,start:b,end:c});a.dispatchEvent(b)}
k.lb=function(){var a=this.f.currentTime;if(null!=this.u){if(a>=this.u-.01&&a<=this.u+.01){this.u=null;return}this.u=null}var b=lf(this,rf(this));if(b){var c=b.end;(b=uf(this,a,b.start,c))||(a<=c+.01?b=!1:(this.f.currentTime=c,b=!0));if(!b)for(var d in this.b)this.b[d].Pa()}};function uf(a,b,c,d){if(b>=c-.01)return!1;a.f.currentTime=Math.min(c+(a.a.b?a.a.c:0),d);return!0}k.nb=function(){if(!this.a.b){for(var a in this.b)if(!this.b[a].La())return;this.g.endOfStream()}};
k.Ab=function(){var a=this.H,b=this.G.getBandwidth();a.estimatedBandwidth=b;a.bandwidthHistory.push(new le(b))};function rf(a){return ab(a.b).map(function(a){return a.Ka()}).filter(function(a){return null!=a})}
function lf(a,b){for(var c=0,d=Number.POSITIVE_INFINITY,e=0;e<b.length;++e){var f=b[e].wa(),c=Math.max(c,f.start);null!=f.end&&(d=Math.min(d,f.end))}if(d==Number.POSITIVE_INFINITY)if(d=a.a.a[0],d.b)d=(d.start||0)+d.b;else return null;a.a.b&&(d=Math.max(d-(a.a.c+a.J),c));return c>d?null:{start:c,end:d}}function gf(a,b){if(null!=a.a.f){var c=Math.max(a.a.f,3),c=Math.max(c-b,0);a.R=window.setTimeout(a.pb.bind(a),1E3*c)}}function tf(a){a.a.b&&(a.O=window.setTimeout(a.qb.bind(a),1E3))};function vf(a,b,c,d){c||(c=new $a);d||(d=new Te);Y.call(this,null,c,d);this.fa=new K([new L(a)]);this.K=b;this.v=[];this.S=[];this.$=[]}p(vf,Y);n("shaka.player.DashVideoSource",vf);vf.prototype.ga=function(a,b,c){this.v.push(a);this.S.push(b||"");this.$.push(c||"")};vf.prototype.addExternalCaptions=vf.prototype.ga;vf.prototype.destroy=function(){this.K=null;Y.prototype.destroy.call(this)};
vf.prototype.U=function(){return td(new sd(this.fa,this.X)).then(C(this,function(a){for(var b=0;b<this.v.length;b++){var c=a,d=this.v[b],e=this.S[b],f=this.$[b];if(0!==c.a.length){var g=new Rc;g.contentType="text";g.lang=e||"en";g.f=!0;e=new Uc;e.bandwidth=0;e.c=f||"text/vtt";e.m=[new L(d)];g.a.push(e);c.a[0].b.push(g);md(c.a[0])}}this.a=Ee(new De(this.K),a);return Y.prototype.U.call(this)}))};vf.prototype.Na=function(a){return td(new sd(a,this.X)).then(C(this,function(a){a=Ee(new De(this.K),a);return Promise.resolve(a)}))};function Z(a,b,c){b||(b=new $a);c||(c=new Te);Y.call(this,null,b,c);this.S=a;this.K=[];this.timeoutMs=3E4;this.v={}}p(Z,Y);n("shaka.player.OfflineVideoSource",Z);Z.prototype.F=function(a){null!=a.licenseRequestTimeout&&(this.v.licenseRequestTimeout=a.licenseRequestTimeout);null!=a.segmentRequestTimeout&&(this.v.segmentRequestTimeout=a.segmentRequestTimeout);Y.prototype.F.call(this,a)};
n("shaka.player.OfflineVideoSource.retrieveGroupIds",function(){var a=new Va,b=Oa(a).then(function(){return Wa(a)});b.then(function(){J(a)}).catch(function(){J(a)});return b});
Z.prototype.ga=function(a,b,c,d){var e,f={},g=[];a=new K([new L(a)]);return td(new sd(a,this.X)).then(C(this,function(a){this.a=Ee(new De(c),a);if(this.a.b)return Promise.reject(Error("Unable to store live streams offline."));this.F({preferredLanguage:b});return Y.prototype.U.call(this)})).then(C(this,function(){var a=document.createElement("video");a.src=window.URL.createObjectURL(this.g);e=new me(null,a,this);null!=this.v.licenseRequestTimeout&&(e.v=Number(this.v.licenseRequestTimeout));H(this.l,
e,"sessionReady",this.$.bind(this));return ne(e)})).then(C(this,function(){for(var a=sa(this.c),b=0;b<a.length;++b)for(var c=a[b],e=0;e<c.o.length;++e){var g=c.o[e];f[g.B]=g}return d()})).then(C(this,function(a){for(var b=0;b<a.length;++b){var c=a[b],d=f[c];if(d)g.push(d);else return Promise.reject(Error("Invalid stream ID chosen: "+c))}var e=["audio","video"];g=g.filter(function(a){return 0>e.indexOf(a.a.split("/")[0])?!1:!0});a=g.map(function(a){return a.A.create()});return Promise.all(a)})).then(C(this,
function(a){for(var b=g,c=[],d=0;d<b.length;++d)try{c[d]=this.g.addSourceBuffer(Vd(b[d]))}catch(e){}if(b.length!=c.length)a=Error("Error initializing streams."),a.type="storage",a=Promise.reject(a);else{for(d=0;d<a.length;++d)(b=a[d])&&c[d].appendBuffer(b);a=Promise.resolve()}return a})).then(C(this,function(){return qe(e,this.timeoutMs)})).then(C(this,function(){return wf(this,g,e.a,this.a.a[0].b)}))};n("shaka.player.OfflineVideoSource.prototype.store",Z.prototype.ga);Z.prototype.$=function(a){this.K.push(a.detail.sessionId)};
function wf(a,b,c,d){var e=new be(a.G,a);null!=a.v.segmentRequestTimeout&&(e.b=Number(a.v.segmentRequestTimeout));return Oa(e).then(C(a,function(){return ce(e,b,this.K,d,c)})).then(function(a){J(e);return Promise.resolve(a)}).catch(function(a){J(e);return Promise.reject(a)})}
Z.prototype.U=function(){var a=new Va,b,c;return Oa(a).then(C(this,function(){return Xa(a,this.S)})).then(C(this,function(d){var e=[];this.K=d.session_ids;b=d.duration;c=d.key_system;for(var f=0;f<d.stream_ids.length;++f)e.push(Ya(a,d.stream_ids[f]));return Promise.all(e)})).then(C(this,function(a){var e=b,f=c,g=new ae;g.c=5;for(var h=new $d,l=0;l<a.length;++l){var m=a[l],t=new Td,q=new Qd(m.references),D=new Uint8Array(m.init_segment),D=new L("data:application/octet-stream;base64,"+Ea(D)),D=new yd(new K([D],
0,null));t.C=q;t.A=D;t.a=m.mime_type;t.b=m.codecs;m=new qb(f,"",!1,null);q=new Wd;q.o.push(t);q.a.push(m);q.contentType=t.a.split("/")[0];h.a.push(q);h.b=e}g.a.push(h);this.a=g;return Y.prototype.U.call(this)})).then(function(){J(a);return Promise.resolve()}).catch(function(b){J(a);return Promise.reject(b)})};Z.prototype.fa=function(){var a=new be(null,null);return Oa(a).then(C(this,function(){return fe(a,this.S)})).then(function(){J(a);return Promise.resolve()}).catch(function(b){J(a);return Promise.reject(b)})};
Z.prototype.deleteGroup=Z.prototype.fa;Z.prototype.pa=function(){return this.K};Z.prototype.ja=function(){return!0};}.bind(g,this))();
if (typeof(module)!="undefined"&&module.exports)module.exports=g.shaka;
else if (typeof(define)!="undefined")define(function(){return g.shaka});
else this.shaka=g.shaka;
})();

